import{C as E,d as W,r as M,o as d,s as P,w as h,e as b,a as c,c as u,l as y,F as v,u as g,D as k,A as w,p as x,h as F,_ as A,t as S,n as G}from"./index-AeagG3uj.js";import{M as $}from"./Modal-BdggWlfk.js";const le=async()=>{let n=await E.get("/openGames");if(console.log(n.data.message),n.data.success)return n.data.openGames},B=async n=>{let l=await E.post("/addOpenGame",n);return console.log(l.data.message),l.data.success},re=(n,l)=>{let s=D(n,l);s=s.filter(e=>e.ammountOfMatches>=3),s=s.filter(e=>{let t=_(n,e.name,l),a=new Set;return t.forEach(r=>{l?r.team1.players[0].name==e.name?a.add(r.team2.players[0].name):a.add(r.team1.players[0].name):r.team1.players.map(m=>m.name).includes(e.name)?a.add(r.team2.players.map(m=>m.name).join(",")):a.add(r.team1.players.map(m=>m.name).join(","))}),a.size>=4}),s.sort((e,t)=>t.averageWins==e.averageWins&&t.wins==e.wins?t.averageScore-e.averageScore:t.averageWins==e.averageWins?t.wins-e.wins:t.averageWins-e.averageWins);for(let e=0;e<s.length;e++){s[e].placement=e;let t=s.filter(a=>a.averageWins==s[e].averageWins&&a.averageScore==s[e].averageScore&&a.wins==s[e].wins);t.length>1&&t.forEach(a=>{a.placement=t[0].placement})}return s},D=(n,l)=>{let s=[];return I(n,l).forEach(t=>{let a=_(n,t,l).length,r=L(n,t,l),m=T(n,t,l),o={name:t,score:r,ammountOfMatches:a,ammountOfMatchesWithTrackedShots:a,ammountOfDrunkenCups:j(),wins:m,averageScore:Math.round((a==0?0:r/a)*100)/100,averageWins:Math.round((a==0?0:m/a)*100)};s.push(o)}),s},I=(n,l)=>{let s=[];return n.forEach(e=>{l?e.team1.players.length==1&&e.team2.players.length==1&&(s.push(...e.team1.players.map(t=>t.name)),s.push(...e.team2.players.map(t=>t.name))):e.team1.players.length==2&&e.team2.players.length==2&&(s.push(...e.team1.players.map(t=>t.name)),s.push(...e.team2.players.map(t=>t.name)))}),s=s.filter((e,t)=>s.indexOf(e)==t),s},_=(n,l,s)=>{let e=[];return n.forEach(t=>{(t.team1.players.map(a=>a.name).includes(l)||t.team2.players.map(a=>a.name).includes(l))&&(s?(t.team1.players.length==1||t.team2.players.length==1)&&e.push(t):(t.team1.players.length==2||t.team2.players.length==2)&&e.push(t))}),e},T=(n,l,s)=>{let e=0;return _(n,l,s).forEach(a=>{if(a.team1.players.map(r=>r.name).includes(l)){let r=a.team1.players.reduce((o,i)=>o+i.score,0),m=a.team2.players.reduce((o,i)=>o+i.score,0);r>m&&e++}if(a.team2.players.map(r=>r.name).includes(l)){let r=a.team1.players.reduce((o,i)=>o+i.score,0);a.team2.players.reduce((o,i)=>o+i.score,0)>r&&e++}}),e},L=(n,l,s)=>{let e=0;return _(n,l,s).forEach(a=>{a.team1.players.map(r=>r.name).includes(l)&&(e+=a.team1.players.find(r=>r.name==l).score),a.team2.players.map(r=>r.name).includes(l)&&(e+=a.team2.players.find(r=>r.name==l).score)}),e},j=(n,l)=>1,q=n=>(x("data-v-4eb9b81d"),n=n(),F(),n),z={class:"rt-modal"},H=["id"],R={class:"rt-modal-team"},U=q(()=>c("input",{class:"rt-modal-input-number",type:"number",placeholder:"0"},null,-1)),J={class:"rt-modal-buttons"},K=["onClick"],Q=W({__name:"ModalAddOpenGame",props:{toggleModalAddGame:{type:Function,required:!0},getOpenGames:{type:Function,required:!0}},setup(n){let l=M(1),s=M(1);const e=n,t=async()=>{let a={team1:{players:[]},team2:{players:[]},time:new Date().getTime()};for(let m=1;m<3;m++){let i=document.getElementById("addOpenGameModal-team-"+m).getElementsByClassName("rt-modal-team");for(let p=0;p<i.length;p++){let f=i[p].getElementsByClassName("rt-modal-input-player")[0].value.trim(),C=parseFloat(i[p].getElementsByClassName("rt-modal-input-number")[0].value.trim()),O={name:f,score:C};m==1?a.team1.players.push(O):a.team2.players.push(O)}}await B(a)&&(await e.getOpenGames(),e.toggleModalAddGame())};return(a,r)=>(d(),P($,null,{title:h(()=>[b("Ergebnis eintragen")]),template:h(()=>[c("div",z,[(d(),u(v,null,y(2,m=>c("div",{id:"addOpenGameModal-team-"+m,class:"rt-modal-container"},[(d(!0),u(v,null,y(m==1?g(l):g(s),o=>(d(),u("div",R,[c("input",{class:"rt-modal-input-player",type:"string",placeholder:"Spielername",style:k({textAlign:m==1?"right":"left",order:m==1?1:3})},null,4),U]))),256)),c("div",J,[c("div",{onClick:o=>m==1?w(l)?l.value++:l++:w(s)?s.value++:s++},"+",8,K)])],8,H)),64))])]),cancle:h(()=>[c("div",{onClick:r[0]||(r[0]=m=>{n.toggleModalAddGame()})},"Abbrechen")]),confirm:h(()=>[c("div",{onClick:r[1]||(r[1]=m=>t())},"Eintragen")]),_:1}))}}),ne=A(Q,[["__scopeId","data-v-4eb9b81d"]]),X={class:"OpenGameMatchElement"},Y={class:"ogm-time"},Z={class:"ogm-game"},N={class:"ogm-game-team"},V={class:"ogm-game-team-player-name"},ee={class:"ogm-game-team-player-score"},te=W({__name:"OpenGameMatchElement",props:{openGame:{type:Object,required:!0}},setup(n){const l=n;let s=new Date(l.openGame.time),e=s.getHours()+":"+(s.getMinutes()<10?"0":"")+s.getMinutes(),t=l.openGame.team1.players.reduce((m,o)=>m+o.score,0),a=l.openGame.team2.players.reduce((m,o)=>m+o.score,0),r=M(t<a);return(m,o)=>(d(),u("div",X,[c("div",Y,S(g(s).toLocaleDateString("de-DE")+"  -  "+g(e)+" Uhr"),1),c("div",Z,[(d(!0),u(v,null,y([n.openGame.team1,n.openGame.team2],(i,p)=>(d(),u("div",N,[(d(!0),u(v,null,y(i.players,f=>(d(),u("div",{class:G(["ogm-game-team-player",{teamLoose:p==0&&g(r)||p==1&&!g(r)}])},[c("div",V,S(f.name),1),c("div",ee,S(f.score),1)],2))),256))]))),256))])]))}}),me=A(te,[["__scopeId","data-v-a739e6ef"]]);export{ne as M,me as O,le as a,re as g};
