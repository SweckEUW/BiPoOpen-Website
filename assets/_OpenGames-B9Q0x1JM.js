import{j as x,d as y,r as h,o as u,k as O,w,g as T,a as l,c as g,l as b,F as _,u as p,n as F,m as W,p as M,h as E,_ as $,t as v,q as f,s as D,b as C,v as L,x as q,y as B,e as k,T as V,z,i as j}from"./index-DirBr2-m.js";import{M as H}from"./Modal-DXGmOVWN.js";import{L as U}from"./Loadingscreen-DK7jHSdu.js";const N=async()=>{let a=await x.get("/openGames");if(console.log(a.data.message),a.data.success)return a.data.openGames},R=async a=>{let t=await x.post("/addOpenGame",a);return console.log(t.data.message),t.data.success},J=a=>{let t=K(a);t.sort((e,s)=>s.averageWins==e.averageWins?s.averageScore-e.averageScore:s.averageScore==e.averageScore?s.wins-e.wins:s.averageWins-e.averageWins);for(let e=0;e<t.length;e++){t[e].placement=e;let s=t.filter(n=>n.averageScore==t[e].averageScore&&n.ammountOfDrunkenCups==t[e].ammountOfDrunkenCups);s.length>1&&s.forEach(n=>{n.placement=s[0].placement})}return t},K=a=>{let t=[];return Q(a).forEach(s=>{let n=P(a,s).length,r=Y(a,s),d=X(a,s),o={name:s,score:r,ammountOfMatches:n,ammountOfDrunkenCups:Z(),wins:d,averageScore:Math.round((n==0?0:r/n)*100)/100,averageWins:Math.round((n==0?0:d/n)*100)};t.push(o)}),t},Q=a=>{let t=[];return a.forEach(e=>{t.push(...e.team1.players.map(s=>s.name)),t.push(...e.team2.players.map(s=>s.name))}),t=t.filter((e,s)=>t.indexOf(e)==s),t},P=(a,t)=>{let e=[];return a.forEach(s=>{(s.team1.players.map(n=>n.name).includes(t)||s.team2.players.map(n=>n.name).includes(t))&&e.push(s)}),e},X=(a,t)=>{let e=0;return P(a,t).forEach(n=>{if(n.team1.players.map(r=>r.name).includes(t)){let r=n.team1.players.reduce((o,c)=>o+c.score,0),d=n.team2.players.reduce((o,c)=>o+c.score,0);r>d&&e++}if(n.team2.players.map(r=>r.name).includes(t)){let r=n.team1.players.reduce((o,c)=>o+c.score,0);n.team2.players.reduce((o,c)=>o+c.score,0)>r&&e++}}),e},Y=(a,t)=>{let e=0;return P(a,t).forEach(n=>{n.team1.players.map(r=>r.name).includes(t)&&(e+=n.team1.players.find(r=>r.name==t).score),n.team2.players.map(r=>r.name).includes(t)&&(e+=n.team2.players.find(r=>r.name==t).score)}),e},Z=(a,t)=>1,ee=a=>(M("data-v-cd6fb282"),a=a(),E(),a),te={class:"rt-modal"},ae=["id"],se={class:"rt-modal-team"},ne=ee(()=>l("input",{class:"rt-modal-input-number",type:"number",placeholder:"0"},null,-1)),le={class:"rt-modal-buttons"},oe=["onClick"],re=y({__name:"ModalAddOpenGame",props:{toggleModalAddGame:{type:Function,required:!0},getOpenGames:{type:Function,required:!0}},setup(a){let t=h(1),e=h(1);const s=a,n=async()=>{let r={team1:{players:[]},team2:{players:[]},time:new Date().getTime()};for(let o=1;o<3;o++){let m=document.getElementById("addOpenGameModal-team-"+o).getElementsByClassName("rt-modal-team");for(let i=0;i<m.length;i++){let S=m[i].getElementsByClassName("rt-modal-input-player")[0].value,I=parseFloat(m[i].getElementsByClassName("rt-modal-input-number")[0].value),A={name:S,score:I};o==1?r.team1.players.push(A):r.team2.players.push(A)}}await R(r)&&(await s.getOpenGames(),s.toggleModalAddGame())};return(r,d)=>(u(),O(H,null,{title:w(()=>[T("Ergebnis eintragen")]),template:w(()=>[l("div",te,[(u(),g(_,null,b(2,o=>l("div",{id:"addOpenGameModal-team-"+o,class:"rt-modal-container"},[(u(!0),g(_,null,b(o==1?p(t):p(e),c=>(u(),g("div",se,[l("input",{class:"rt-modal-input-player",type:"string",placeholder:"Spielername",style:F({textAlign:o==1?"right":"left",order:o==1?1:3})},null,4),ne]))),256)),l("div",le,[l("div",{onClick:c=>o==1?W(t)?t.value++:t++:W(e)?e.value++:e++},"+",8,oe)])],8,ae)),64))])]),cancle:w(()=>[l("div",{onClick:d[0]||(d[0]=o=>{a.toggleModalAddGame()})},"Abbrechen")]),confirm:w(()=>[l("div",{onClick:d[1]||(d[1]=o=>n())},"Eintragen")]),_:1}))}}),ie=$(re,[["__scopeId","data-v-cd6fb282"]]),ce={class:"OpenGameMatchElement"},me={class:"ogm-time"},de={class:"ogm-game"},ue={class:"ogm-game-team"},pe={class:"ogm-game-team-player-name"},ve={class:"ogm-game-team-player-score"},ge=y({__name:"OpenGameMatchElement",props:{openGame:{type:Object,required:!0}},setup(a){const t=a;let e=new Date(t.openGame.time),s=e.getHours()+":"+e.getMinutes(),n=t.openGame.team1.players.reduce((o,c)=>o+c.score,0),r=t.openGame.team2.players.reduce((o,c)=>o+c.score,0),d=h(n<r);return(o,c)=>(u(),g("div",ce,[l("div",me,v(p(e).toLocaleDateString("de-DE")+"  -  "+p(s)+" Uhr"),1),l("div",de,[(u(!0),g(_,null,b([a.openGame.team1,a.openGame.team2],(m,i)=>(u(),g("div",ue,[(u(!0),g(_,null,b(m.players,S=>(u(),g("div",{class:f(["ogm-game-team-player",{teamLoose:i==0&&p(d)||i==1&&!p(d)}])},[l("div",pe,v(S.name),1),l("div",ve,v(S.score),1)],2))),256))]))),256))])]))}}),he=$(ge,[["__scopeId","data-v-74d15203"]]),G=a=>(M("data-v-a8275ba4"),a=a(),E(),a),fe={class:"table table-hover caption-top"},_e={style:{height:"auto"}},Se={key:0,class:"ogs-explain"},be=G(()=>l("div",null,"*Pl. = Platz",-1)),we=G(()=>l("div",null,"*Spi. = Spiele",-1)),Ge=G(()=>l("div",null,"*Sieg. = Siege",-1)),Oe=G(()=>l("div",null,"*Trfq. = Trefferquote",-1)),ye=G(()=>l("div",null,"*Siegwahr. = Siegwahrscheinlichkeit",-1)),$e=[be,we,Ge,Oe,ye],ke=y({__name:"OpenGamesStatistics",props:{openGames:{type:Object,required:!0}},setup(a){const t=a;let e=h("averageWins"),s=h(!1),n=h(window.screen.width);window.addEventListener("resize",()=>{n.value=window.screen.width});const r=D(()=>{let c=J(t.openGames);return c.sort((m,i)=>e.value=="name"?s.value?m[e.value].localeCompare(i[e.value]):i[e.value].localeCompare(m[e.value]):i[e.value]==m[e.value]?s.value?i.placement-m.placement:m.placement-i.placement:s.value?m[e.value]-i[e.value]:i[e.value]-m[e.value]),c}),d=c=>{e.value==c?s.value=!s.value:s.value=!1,e.value=c},o=c=>{if(c==e.value)return s.value?"ogs-arrow ogs-arrow-up":"ogs-arrow ogs-arrow-down"};return(c,m)=>(u(),g(_,null,[l("table",fe,[l("thead",null,[l("tr",_e,[l("th",{onClick:m[0]||(m[0]=i=>d("placement")),class:f(o("placement"))},v(p(n)>900?"Platz":"Pl."),3),l("th",{onClick:m[1]||(m[1]=i=>d("name")),class:f(o("name"))},v("Name"),2),l("th",{onClick:m[2]||(m[2]=i=>d("ammountOfMatches")),class:f(o("ammountOfMatches"))},v(p(n)>900?"Spiele":"Spi."),3),l("th",{onClick:m[3]||(m[3]=i=>d("wins")),class:f(o("wins"))},v(p(n)>900?"Siege":"Sieg."),3),l("th",{onClick:m[4]||(m[4]=i=>d("averageScore")),class:f(o("averageScore"))},v(p(n)>900?"Trefferquote":"Trfq."),3),l("th",{onClick:m[5]||(m[5]=i=>d("averageWins")),class:f(o("averageWins"))},v(p(n)>900?"Siegwahrscheinlichkeit":"Siegwahr."),3)])]),l("tbody",null,[(u(!0),g(_,null,b(r.value,(i,S)=>(u(),g("tr",{key:S},[l("td",null,v(i.placement+1),1),l("td",null,v(i.name.replace(" ",`
`)),1),l("td",null,v(i.ammountOfMatches),1),l("td",null,v(i.wins),1),l("td",null,v(i.averageScore),1),l("td",null,v(i.averageWins+"%"),1)]))),128))])]),p(n)<900?(u(),g("div",Se,$e)):C("",!0)],64))}}),Ce=$(ke,[["__scopeId","data-v-a8275ba4"]]),Me=a=>(M("data-v-e392ba40"),a=a(),E(),a),Ee={class:"HallofFame"},Pe=Me(()=>l("h1",{class:"bp-title"},v("Offene Spiele"),-1)),Ae={key:0},We=j('<ul class="nav nav-tabs justify-content-center" data-v-e392ba40><li class="nav-item" data-v-e392ba40><button class="nav-link active" data-bs-toggle="tab" data-bs-target="#OpenGamesMain" data-v-e392ba40>Vergangene Spiele</button></li><li class="nav-item" data-v-e392ba40><button class="nav-link" data-bs-toggle="tab" data-bs-target="#OpenGamesStats" data-v-e392ba40>Statistiken</button></li></ul>',1),xe={class:"tab-content",id:"GameScheduleContainer"},Ie={class:"tab-pane fade show active",id:"OpenGamesMain"},Te={class:"tab-pane fade",id:"OpenGamesStats"},Fe=y({__name:"_OpenGames",setup(a){let t=h(),e=h(!1);const s=async()=>{t.value=await N(),t.value=t.value.reverse()};s();let n=setInterval(()=>{s()},1e4);L(()=>{clearInterval(n)});const r=()=>{e.value=!e.value};return(d,o)=>(u(),g("div",Ee,[Pe,q(k(U,null,null,512),[[B,!p(t)]]),p(t)?(u(),g("div",Ae,[l("div",{class:"bp-button",onClick:o[0]||(o[0]=c=>r())},"Spiel eintragen"),(u(),O(z,{to:"body"},[k(V,{name:"fade"},{default:w(()=>[p(e)?(u(),O(ie,{key:0,toggleModalAddGame:r,getOpenGames:s})):C("",!0)]),_:1})])),We,l("div",xe,[l("div",Ie,[(u(!0),g(_,null,b(p(t),c=>(u(),O(he,{openGame:c},null,8,["openGame"]))),256))]),l("div",Te,[k(Ce,{openGames:p(t)},null,8,["openGames"])])])])):C("",!0)]))}}),Be=$(Fe,[["__scopeId","data-v-e392ba40"]]);export{Be as default};
