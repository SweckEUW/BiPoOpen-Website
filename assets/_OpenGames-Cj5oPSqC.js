import{j as W,d as $,r as S,o as u,k as G,w as O,g as F,a as n,c as p,l as y,F as w,u as v,n as I,m as E,p as x,h as T,_ as C,t as g,q as b,s as B,v as q,b as M,x as L,y as D,z as V,e as k,T as z,A as j,i as H}from"./index-B_P9r_5F.js";import{M as U}from"./Modal-DHMPpVBp.js";import{L as N}from"./Loadingscreen-CVxXk0gt.js";import{S as R,P as J}from"./pagination-CEgt5EwY.js";const K=async()=>{let l=await W.get("/openGames");if(console.log(l.data.message),l.data.success)return l.data.openGames},Q=async l=>{let s=await W.post("/addOpenGame",l);return console.log(s.data.message),s.data.success},A=(l,s)=>{let e=X(l,s);e.sort((t,a)=>a.averageWins==t.averageWins?a.averageScore-t.averageScore:a.averageScore==t.averageScore?a.wins-t.wins:a.averageWins-t.averageWins);for(let t=0;t<e.length;t++){e[t].placement=t;let a=e.filter(o=>o.averageWins==e[t].averageWins&&o.averageScore==e[t].averageScore&&o.wins==e[t].wins);a.length>1&&a.forEach(o=>{o.placement=a[0].placement})}return e},X=(l,s)=>{let e=[];return Y(l,s).forEach(a=>{let o=P(l,a,s).length,r=ee(l,a,s),i=Z(l,a,s),c={name:a,score:r,ammountOfMatches:o,ammountOfDrunkenCups:te(),wins:i,averageScore:Math.round((o==0?0:r/o)*100)/100,averageWins:Math.round((o==0?0:i/o)*100)};e.push(c)}),e},Y=(l,s)=>{let e=[];return l.forEach(t=>{s?t.team1.players.length==1&&t.team2.players.length==1&&(e.push(...t.team1.players.map(a=>a.name)),e.push(...t.team2.players.map(a=>a.name))):t.team1.players.length==2&&t.team2.players.length==2&&(e.push(...t.team1.players.map(a=>a.name)),e.push(...t.team2.players.map(a=>a.name)))}),e=e.filter((t,a)=>e.indexOf(t)==a),e},P=(l,s,e)=>{let t=[];return l.forEach(a=>{(a.team1.players.map(o=>o.name).includes(s)||a.team2.players.map(o=>o.name).includes(s))&&(e?(a.team1.players.length==1||a.team2.players.length==1)&&t.push(a):(a.team1.players.length==2||a.team2.players.length==2)&&t.push(a))}),t},Z=(l,s,e)=>{let t=0;return P(l,s,e).forEach(o=>{if(o.team1.players.map(r=>r.name).includes(s)){let r=o.team1.players.reduce((c,m)=>c+m.score,0),i=o.team2.players.reduce((c,m)=>c+m.score,0);r>i&&t++}if(o.team2.players.map(r=>r.name).includes(s)){let r=o.team1.players.reduce((c,m)=>c+m.score,0);o.team2.players.reduce((c,m)=>c+m.score,0)>r&&t++}}),t},ee=(l,s,e)=>{let t=0;return P(l,s,e).forEach(o=>{o.team1.players.map(r=>r.name).includes(s)&&(t+=o.team1.players.find(r=>r.name==s).score),o.team2.players.map(r=>r.name).includes(s)&&(t+=o.team2.players.find(r=>r.name==s).score)}),t},te=(l,s)=>1,ae=l=>(x("data-v-3c09c64b"),l=l(),T(),l),se={class:"rt-modal"},ne=["id"],le={class:"rt-modal-team"},oe=ae(()=>n("input",{class:"rt-modal-input-number",type:"number",placeholder:"0"},null,-1)),re={class:"rt-modal-buttons"},ie=["onClick"],ce=$({__name:"ModalAddOpenGame",props:{toggleModalAddGame:{type:Function,required:!0},getOpenGames:{type:Function,required:!0}},setup(l){let s=S(1),e=S(1);const t=l,a=async()=>{let o={team1:{players:[]},team2:{players:[]},time:new Date().getTime()};for(let i=1;i<3;i++){let m=document.getElementById("addOpenGameModal-team-"+i).getElementsByClassName("rt-modal-team");for(let h=0;h<m.length;h++){let _=m[h].getElementsByClassName("rt-modal-input-player")[0].value.trim(),d=parseFloat(m[h].getElementsByClassName("rt-modal-input-number")[0].value.trim()),f={name:_,score:d};i==1?o.team1.players.push(f):o.team2.players.push(f)}}await Q(o)&&(await t.getOpenGames(),t.toggleModalAddGame())};return(o,r)=>(u(),G(U,null,{title:O(()=>[F("Ergebnis eintragen")]),template:O(()=>[n("div",se,[(u(),p(w,null,y(2,i=>n("div",{id:"addOpenGameModal-team-"+i,class:"rt-modal-container"},[(u(!0),p(w,null,y(i==1?v(s):v(e),c=>(u(),p("div",le,[n("input",{class:"rt-modal-input-player",type:"string",placeholder:"Spielername",style:I({textAlign:i==1?"right":"left",order:i==1?1:3})},null,4),oe]))),256)),n("div",re,[n("div",{onClick:c=>i==1?E(s)?s.value++:s++:E(e)?e.value++:e++},"+",8,ie)])],8,ne)),64))])]),cancle:O(()=>[n("div",{onClick:r[0]||(r[0]=i=>{l.toggleModalAddGame()})},"Abbrechen")]),confirm:O(()=>[n("div",{onClick:r[1]||(r[1]=i=>a())},"Eintragen")]),_:1}))}}),me=C(ce,[["__scopeId","data-v-3c09c64b"]]),de={class:"OpenGameMatchElement"},ue={class:"ogm-time"},pe={class:"ogm-game"},ve={class:"ogm-game-team"},ge={class:"ogm-game-team-player-name"},he={class:"ogm-game-team-player-score"},fe=$({__name:"OpenGameMatchElement",props:{openGame:{type:Object,required:!0}},setup(l){const s=l;let e=new Date(s.openGame.time),t=e.getHours()+":"+(e.getMinutes()<10?"0":"")+e.getMinutes(),a=s.openGame.team1.players.reduce((i,c)=>i+c.score,0),o=s.openGame.team2.players.reduce((i,c)=>i+c.score,0),r=S(a<o);return(i,c)=>(u(),p("div",de,[n("div",ue,g(v(e).toLocaleDateString("de-DE")+"  -  "+v(t)+" Uhr"),1),n("div",pe,[(u(!0),p(w,null,y([l.openGame.team1,l.openGame.team2],(m,h)=>(u(),p("div",ve,[(u(!0),p(w,null,y(m.players,_=>(u(),p("div",{class:b(["ogm-game-team-player",{teamLoose:h==0&&v(r)||h==1&&!v(r)}])},[n("div",ge,g(_.name),1),n("div",he,g(_.score),1)],2))),256))]))),256))])]))}}),_e=C(fe,[["__scopeId","data-v-35b99930"]]),Se=n("div",{class:"swiper-pagination",id:"OpenGamesStatisticsSwiper-Pagination"},null,-1),we={class:"OpenGamesStatistics swiper-container",id:"OpenGamesStatisticsSwiper"},be={class:"swiper-wrapper"},ye={class:"table table-hover caption-top"},Oe={style:{height:"auto"}},Ge={key:0,class:"ogs-explain"},$e=n("div",null,"*Pl. = Platz",-1),ke=n("div",null,"*Spi. = Spiele",-1),Me=n("div",null,"*Sieg. = Siege",-1),Ce=n("div",null,"*Trfq. = Trefferquote",-1),Pe=n("div",null,"*Siegwahr. = Siegwahrscheinlichkeit",-1),Ee=[$e,ke,Me,Ce,Pe],Ae=$({__name:"OpenGamesStatistics",props:{openGames:{type:Object,required:!0}},setup(l){const s=l;let e=S("averageWins"),t=S(!1),a=S(window.screen.width);window.addEventListener("resize",()=>{a.value=window.screen.width});const o=B(()=>{let c=A(s.openGames,!0),m=A(s.openGames,!1),h=[c,m];return h.forEach(_=>{_.sort((d,f)=>e.value=="name"?t.value?d[e.value].localeCompare(f[e.value]):f[e.value].localeCompare(d[e.value]):f[e.value]==d[e.value]?t.value?f.placement-d.placement:d.placement-f.placement:t.value?d[e.value]-f[e.value]:f[e.value]-d[e.value])}),h}),r=c=>{e.value==c?t.value=!t.value:t.value=!1,e.value=c},i=c=>{if(c==e.value)return t.value?"ogs-arrow ogs-arrow-up":"ogs-arrow ogs-arrow-down"};return q(()=>{new R("#OpenGamesStatisticsSwiper",{modules:[J],initialSlide:0,spaceBetween:50,speed:500,pagination:{el:"#OpenGamesStatisticsSwiper-Pagination",clickable:!0,renderBullet:(c,m)=>'<span class="'+m+'">'+(c==0?"1 vs. 1":"2 vs. 2")+"</span>"}})}),(c,m)=>(u(),p(w,null,[Se,n("div",we,[n("div",be,[(u(!0),p(w,null,y(o.value,(h,_)=>(u(),p("div",{class:"rt-table swiper-slide",key:_},[n("table",ye,[n("thead",null,[n("tr",Oe,[n("th",{onClick:m[0]||(m[0]=d=>r("placement")),class:b(i("placement"))},g(v(a)>900?"Platz":"Pl."),3),n("th",{onClick:m[1]||(m[1]=d=>r("name")),class:b(i("name"))},g("Name"),2),n("th",{onClick:m[2]||(m[2]=d=>r("ammountOfMatches")),class:b(i("ammountOfMatches"))},g(v(a)>900?"Spiele":"Spi."),3),n("th",{onClick:m[3]||(m[3]=d=>r("wins")),class:b(i("wins"))},g(v(a)>900?"Siege":"Sieg."),3),n("th",{onClick:m[4]||(m[4]=d=>r("averageScore")),class:b(i("averageScore"))},g(v(a)>900?"Trefferquote":"Trfq."),3),n("th",{onClick:m[5]||(m[5]=d=>r("averageWins")),class:b(i("averageWins"))},g(v(a)>900?"Siegwahrscheinlichkeit":"Siegwahr."),3)])]),n("tbody",null,[(u(!0),p(w,null,y(h,(d,f)=>(u(),p("tr",{key:f},[n("td",null,g(d.placement+1),1),n("td",null,g(d.name.replace(" ",`
`)),1),n("td",null,g(d.ammountOfMatches),1),n("td",null,g(d.wins),1),n("td",null,g(d.averageScore),1),n("td",null,g(d.averageWins+"%"),1)]))),128))])]),v(a)<900?(u(),p("div",Ge,Ee)):M("",!0)]))),128))])])],64))}}),We=l=>(x("data-v-4468a2b7"),l=l(),T(),l),xe={class:"HallofFame"},Te=We(()=>n("h1",{class:"bp-title"},g("Offene Spiele"),-1)),Fe={key:0},Ie=H('<ul class="nav nav-tabs justify-content-center" data-v-4468a2b7><li class="nav-item" data-v-4468a2b7><button class="nav-link active" data-bs-toggle="tab" data-bs-target="#OpenGamesMain" data-v-4468a2b7>Vergangene Spiele</button></li><li class="nav-item" data-v-4468a2b7><button class="nav-link" data-bs-toggle="tab" data-bs-target="#OpenGamesStats" data-v-4468a2b7>Statistiken</button></li></ul>',1),Be={class:"tab-content",id:"OpenGamesStatisticsContainer"},qe={class:"tab-pane fade show active",id:"OpenGamesMain"},Le={class:"tab-pane fade",id:"OpenGamesStats"},De=$({__name:"_OpenGames",setup(l){let s=S(),e=S(!1);const t=async()=>{s.value=await K(),s.value=s.value.reverse()};t();let a=setInterval(()=>{t()},1e4);L(()=>{clearInterval(a)});const o=()=>{e.value=!e.value};return(r,i)=>(u(),p("div",xe,[Te,D(k(N,null,null,512),[[V,!v(s)]]),v(s)?(u(),p("div",Fe,[n("div",{class:"bp-button",onClick:i[0]||(i[0]=c=>o())},"Spiel eintragen"),(u(),G(j,{to:"body"},[k(z,{name:"fade"},{default:O(()=>[v(e)?(u(),G(me,{key:0,toggleModalAddGame:o,getOpenGames:t})):M("",!0)]),_:1})])),Ie,n("div",Be,[n("div",qe,[(u(!0),p(w,null,y(v(s),c=>(u(),G(_e,{openGame:c},null,8,["openGame"]))),256))]),n("div",Le,[k(Ae,{openGames:v(s)},null,8,["openGames"])])])])):M("",!0)]))}}),Ue=C(De,[["__scopeId","data-v-4468a2b7"]]);export{Ue as default};
