import{j as A,d as $,r as S,o as u,k as G,w as b,g as F,a as n,c as p,l as O,F as w,u as v,n as I,m as W,p as T,h as x,_ as C,t as g,q as y,s as B,v as q,b as M,x as L,y as D,z as V,e as k,T as z,A as j,i as H}from"./index-TzYTwey8.js";import{M as U}from"./Modal-BxMPXqN9.js";import{L as N}from"./Loadingscreen-D-04vIWI.js";import{S as R,P as J}from"./pagination-DClv5t0w.js";const K=async()=>{let o=await A.get("/openGames");if(console.log(o.data.message),o.data.success)return o.data.openGames},Q=async o=>{let s=await A.post("/addOpenGame",o);return console.log(s.data.message),s.data.success},E=(o,s)=>{let e=X(o,s);e.sort((t,a)=>a.averageWins==t.averageWins&&a.wins==t.wins?a.averageScore-t.averageScore:a.averageWins==t.averageWins?a.wins-t.wins:a.averageWins-t.averageWins);for(let t=0;t<e.length;t++){e[t].placement=t;let a=e.filter(l=>l.averageWins==e[t].averageWins&&l.averageScore==e[t].averageScore&&l.wins==e[t].wins);a.length>1&&a.forEach(l=>{l.placement=a[0].placement})}return e},X=(o,s)=>{let e=[];return Y(o,s).forEach(a=>{let l=P(o,a,s).length,r=ee(o,a,s),i=Z(o,a,s),c={name:a,score:r,ammountOfMatches:l,ammountOfMatchesWithTrackedShots:l,ammountOfDrunkenCups:te(),wins:i,averageScore:Math.round((l==0?0:r/l)*100)/100,averageWins:Math.round((l==0?0:i/l)*100)};e.push(c)}),e},Y=(o,s)=>{let e=[];return o.forEach(t=>{s?t.team1.players.length==1&&t.team2.players.length==1&&(e.push(...t.team1.players.map(a=>a.name)),e.push(...t.team2.players.map(a=>a.name))):t.team1.players.length==2&&t.team2.players.length==2&&(e.push(...t.team1.players.map(a=>a.name)),e.push(...t.team2.players.map(a=>a.name)))}),e=e.filter((t,a)=>e.indexOf(t)==a),e},P=(o,s,e)=>{let t=[];return o.forEach(a=>{(a.team1.players.map(l=>l.name).includes(s)||a.team2.players.map(l=>l.name).includes(s))&&(e?(a.team1.players.length==1||a.team2.players.length==1)&&t.push(a):(a.team1.players.length==2||a.team2.players.length==2)&&t.push(a))}),t},Z=(o,s,e)=>{let t=0;return P(o,s,e).forEach(l=>{if(l.team1.players.map(r=>r.name).includes(s)){let r=l.team1.players.reduce((c,m)=>c+m.score,0),i=l.team2.players.reduce((c,m)=>c+m.score,0);r>i&&t++}if(l.team2.players.map(r=>r.name).includes(s)){let r=l.team1.players.reduce((c,m)=>c+m.score,0);l.team2.players.reduce((c,m)=>c+m.score,0)>r&&t++}}),t},ee=(o,s,e)=>{let t=0;return P(o,s,e).forEach(l=>{l.team1.players.map(r=>r.name).includes(s)&&(t+=l.team1.players.find(r=>r.name==s).score),l.team2.players.map(r=>r.name).includes(s)&&(t+=l.team2.players.find(r=>r.name==s).score)}),t},te=(o,s)=>1,ae=o=>(T("data-v-4eb9b81d"),o=o(),x(),o),se={class:"rt-modal"},ne=["id"],le={class:"rt-modal-team"},oe=ae(()=>n("input",{class:"rt-modal-input-number",type:"number",placeholder:"0"},null,-1)),re={class:"rt-modal-buttons"},ie=["onClick"],ce=$({__name:"ModalAddOpenGame",props:{toggleModalAddGame:{type:Function,required:!0},getOpenGames:{type:Function,required:!0}},setup(o){let s=S(1),e=S(1);const t=o,a=async()=>{let l={team1:{players:[]},team2:{players:[]},time:new Date().getTime()};for(let i=1;i<3;i++){let m=document.getElementById("addOpenGameModal-team-"+i).getElementsByClassName("rt-modal-team");for(let h=0;h<m.length;h++){let _=m[h].getElementsByClassName("rt-modal-input-player")[0].value.trim(),d=parseFloat(m[h].getElementsByClassName("rt-modal-input-number")[0].value.trim()),f={name:_,score:d};i==1?l.team1.players.push(f):l.team2.players.push(f)}}await Q(l)&&(await t.getOpenGames(),t.toggleModalAddGame())};return(l,r)=>(u(),G(U,null,{title:b(()=>[F("Ergebnis eintragen")]),template:b(()=>[n("div",se,[(u(),p(w,null,O(2,i=>n("div",{id:"addOpenGameModal-team-"+i,class:"rt-modal-container"},[(u(!0),p(w,null,O(i==1?v(s):v(e),c=>(u(),p("div",le,[n("input",{class:"rt-modal-input-player",type:"string",placeholder:"Spielername",style:I({textAlign:i==1?"right":"left",order:i==1?1:3})},null,4),oe]))),256)),n("div",re,[n("div",{onClick:c=>i==1?W(s)?s.value++:s++:W(e)?e.value++:e++},"+",8,ie)])],8,ne)),64))])]),cancle:b(()=>[n("div",{onClick:r[0]||(r[0]=i=>{o.toggleModalAddGame()})},"Abbrechen")]),confirm:b(()=>[n("div",{onClick:r[1]||(r[1]=i=>a())},"Eintragen")]),_:1}))}}),me=C(ce,[["__scopeId","data-v-4eb9b81d"]]),de={class:"OpenGameMatchElement"},ue={class:"ogm-time"},pe={class:"ogm-game"},ve={class:"ogm-game-team"},ge={class:"ogm-game-team-player-name"},he={class:"ogm-game-team-player-score"},fe=$({__name:"OpenGameMatchElement",props:{openGame:{type:Object,required:!0}},setup(o){const s=o;let e=new Date(s.openGame.time),t=e.getHours()+":"+(e.getMinutes()<10?"0":"")+e.getMinutes(),a=s.openGame.team1.players.reduce((i,c)=>i+c.score,0),l=s.openGame.team2.players.reduce((i,c)=>i+c.score,0),r=S(a<l);return(i,c)=>(u(),p("div",de,[n("div",ue,g(v(e).toLocaleDateString("de-DE")+"  -  "+v(t)+" Uhr"),1),n("div",pe,[(u(!0),p(w,null,O([o.openGame.team1,o.openGame.team2],(m,h)=>(u(),p("div",ve,[(u(!0),p(w,null,O(m.players,_=>(u(),p("div",{class:y(["ogm-game-team-player",{teamLoose:h==0&&v(r)||h==1&&!v(r)}])},[n("div",ge,g(_.name),1),n("div",he,g(_.score),1)],2))),256))]))),256))])]))}}),_e=C(fe,[["__scopeId","data-v-a739e6ef"]]),Se=n("div",{class:"swiper-pagination",id:"OpenGamesStatisticsSwiper-Pagination"},null,-1),we={class:"OpenGamesStatistics swiper-container",id:"OpenGamesStatisticsSwiper"},ye={class:"swiper-wrapper"},Oe={class:"table table-hover caption-top"},be={style:{height:"auto"}},Ge={key:0,class:"ogs-explain"},$e=n("div",null,"*Pl. = Platz",-1),ke=n("div",null,"*Spi. = Spiele",-1),Me=n("div",null,"*Sieg. = Siege",-1),Ce=n("div",null,"*Trfq. = Trefferquote",-1),Pe=n("div",null,"*Siegwahr. = Siegwahrscheinlichkeit",-1),We=[$e,ke,Me,Ce,Pe],Ee=$({__name:"OpenGamesStatistics",props:{openGames:{type:Object,required:!0}},setup(o){const s=o;let e=S("averageWins"),t=S(!1),a=S(window.screen.width);window.addEventListener("resize",()=>{a.value=window.screen.width});const l=B(()=>{let c=E(s.openGames,!0),m=E(s.openGames,!1),h=[c,m];return h.forEach(_=>{_.sort((d,f)=>e.value=="name"?t.value?d[e.value].localeCompare(f[e.value]):f[e.value].localeCompare(d[e.value]):f[e.value]==d[e.value]?t.value?f.placement-d.placement:d.placement-f.placement:t.value?d[e.value]-f[e.value]:f[e.value]-d[e.value])}),h}),r=c=>{e.value==c?t.value=!t.value:t.value=!1,e.value=c},i=c=>{if(c==e.value)return t.value?"ogs-arrow ogs-arrow-up":"ogs-arrow ogs-arrow-down"};return q(()=>{new R("#OpenGamesStatisticsSwiper",{modules:[J],initialSlide:0,spaceBetween:50,speed:500,pagination:{el:"#OpenGamesStatisticsSwiper-Pagination",clickable:!0,renderBullet:(c,m)=>'<span class="'+m+'">'+(c==0?"1 vs. 1":"2 vs. 2")+"</span>"}})}),(c,m)=>(u(),p(w,null,[Se,n("div",we,[n("div",ye,[(u(!0),p(w,null,O(l.value,(h,_)=>(u(),p("div",{class:"rt-table swiper-slide",key:_},[n("table",Oe,[n("thead",null,[n("tr",be,[n("th",{onClick:m[0]||(m[0]=d=>r("placement")),class:y(i("placement"))},g(v(a)>900?"Platz":"Pl."),3),n("th",{onClick:m[1]||(m[1]=d=>r("name")),class:y(i("name"))},g("Name"),2),n("th",{onClick:m[2]||(m[2]=d=>r("ammountOfMatches")),class:y(i("ammountOfMatches"))},g(v(a)>900?"Spiele":"Spi."),3),n("th",{onClick:m[3]||(m[3]=d=>r("wins")),class:y(i("wins"))},g(v(a)>900?"Siege":"Sieg."),3),n("th",{onClick:m[4]||(m[4]=d=>r("averageScore")),class:y(i("averageScore"))},g(v(a)>900?"Trefferquote":"Trfq."),3),n("th",{onClick:m[5]||(m[5]=d=>r("averageWins")),class:y(i("averageWins"))},g(v(a)>900?"Siegwahrscheinlichkeit":"Siegwahr."),3)])]),n("tbody",null,[(u(!0),p(w,null,O(h,(d,f)=>(u(),p("tr",{key:f},[n("td",null,g(d.placement+1),1),n("td",null,g(d.name.replace(" ",`
`)),1),n("td",null,g(d.ammountOfMatches),1),n("td",null,g(d.wins),1),n("td",null,g(d.averageScore),1),n("td",null,g(d.averageWins+"%"),1)]))),128))])]),v(a)<900?(u(),p("div",Ge,We)):M("",!0)]))),128))])])],64))}}),Ae=o=>(T("data-v-2ea4c4da"),o=o(),x(),o),Te={class:"HallofFame"},xe=Ae(()=>n("h1",{class:"bp-title"},g("Offene Spiele"),-1)),Fe={key:0},Ie=H('<ul class="nav nav-tabs justify-content-center" data-v-2ea4c4da><li class="nav-item" data-v-2ea4c4da><button class="nav-link active" data-bs-toggle="tab" data-bs-target="#OpenGamesMain" data-v-2ea4c4da>Vergangene Spiele</button></li><li class="nav-item" data-v-2ea4c4da><button class="nav-link" data-bs-toggle="tab" data-bs-target="#OpenGamesStats" data-v-2ea4c4da>Statistiken</button></li></ul>',1),Be={class:"tab-content",id:"OpenGamesStatisticsContainer"},qe={class:"tab-pane fade show active",id:"OpenGamesMain"},Le={class:"tab-pane fade",id:"OpenGamesStats"},De=$({__name:"_OpenGames",setup(o){let s=S(),e=S(!1);const t=async()=>{s.value=await K(),s.value=s.value.reverse()};t();let a=setInterval(()=>{t()},1e4);L(()=>{clearInterval(a)});const l=()=>{e.value=!e.value};return(r,i)=>(u(),p("div",Te,[xe,D(k(N,null,null,512),[[V,!v(s)]]),v(s)?(u(),p("div",Fe,[n("div",{class:"bp-button",onClick:i[0]||(i[0]=c=>l())},"Spiel eintragen"),(u(),G(j,{to:"body"},[k(z,{name:"fade"},{default:b(()=>[v(e)?(u(),G(me,{key:0,toggleModalAddGame:l,getOpenGames:t})):M("",!0)]),_:1})])),Ie,n("div",Be,[n("div",qe,[(u(!0),p(w,null,O(v(s),c=>(u(),G(_e,{openGame:c},null,8,["openGame"]))),256))]),n("div",Le,[k(Ee,{openGames:v(s)},null,8,["openGames"])])])])):M("",!0)]))}}),Ue=C(De,[["__scopeId","data-v-2ea4c4da"]]);export{Ue as default};
