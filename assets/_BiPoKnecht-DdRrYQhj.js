import{d as z,q as F,c as p,n as g,v as A,b as n,x as O,u as a,a as N,t as P,F as C,l as E,o as m,_ as K,r as T,j as J,k as j,w,m as S,h as L,z as W,p as Q,g as X,A as Y,e as D}from"./index-CDYqcVY6.js";import{M as Z}from"./Modal-uCBDvwwQ.js";import{g as ee,a as te}from"./OpenGamesUtilFunctions-BrSCSd5E.js";const ae={class:"ra-middle"},le={style:{width:"100%","text-align":"center"}},se={class:"ra-buttons"},ie=["id"],re=["onClick","id"],ne=["id"],oe=["id"],ce=["id"],de=z({__name:"Rack",props:{isTeam1:{type:Boolean,required:!0},infoText:{type:String,required:!0},activeTeamIndex:{type:Number,required:!0},activeTeam:{type:Object,required:!0},activePlayer:{type:Object,required:!0},activePlayerIndex:{type:Number,required:!0},cupsHit:{type:Array,required:!0},cupsHitEnemyTeam:{type:Array,required:!0},switchActivePlayer:{type:Function,required:!0},turns:{type:Array,required:!0},modifier:{type:null,required:!0},setModifier:{type:Function,required:!0},setInfoText:{type:Function,required:!0},setModalGameOverVisible:{type:Function,required:!0}},setup(r){const e=r;let x=0,d=[],y=(l,t)=>{const s=l-1,i=t-1;return s*(s+1)/2+i},u=async(l,t)=>{let s=c(e.activeTeamIndex==0?1:0,e.activePlayerIndex);if(s.style.opacity="1",l=="miss"&&(console.log("Miss"),b(s,`ra-null-team-${e.activeTeamIndex==0?1:0}`)),l=="airball"&&(console.log("Airball"),b(s,`ra-airball-team-${e.activeTeamIndex==0?1:0}`)),l=="hit"&&(console.log("Hit"),d.push(t.cupIndex),f(s,t.cupIndex)),e.modifier=="bouncer"&&l=="hit"&&(console.log("Bouncer"),e.setInfoText(e.activePlayer.name+" bitte den zweiten Becher vom Bouncer auswählen!"),e.setModifier(void 0),l="bouncer",t={cupIndex1:t.cupIndex,cupIndex2:await B()},d.push(t.cupIndex2)),e.modifier=="trickshot"&&l=="miss"){console.log("Trickshot"),l="trickshot",q(l,t),e.switchActivePlayer(e.activeTeamIndex,e.activePlayerIndex),e.setModifier(void 0),e.setInfoText(e.activePlayer.name+" bitte Trickshot eintragen!");return}let i=e.turns[e.turns.length-1];if(e.activePlayerIndex!=0&&(i.type=="bouncer"||i.type=="hit")&&(l=="hit"||l=="bouncer")){let $=i.type=="hit"?i.data.cupIndex:i.data.cupIndex1,_=l=="hit"?t.cupIndex:t.cupIndex1;if($==_){console.log("Bomb"),e.setInfoText(e.activePlayer.name+" bitte den zweiten Becher der Bombe auswählen!");let H=await B();e.setInfoText(e.activePlayer.name+" bitte den dritten Becher der Bombe auswählen!");let G=await B();l="bomb",t={cupIndex1:t.cupIndex,cupIndex2:H,cupIndex3:G},d.push(H,G)}else console.log("balls back"),l="ballsback",t={cupIndex1:t.cupIndex};V(),R(),q(l,t),e.switchActivePlayer(e.activeTeamIndex,0);return}e.cupsHit.length+d.length==10&&i.type!="lastCup"&&(console.log("lastCup"),l="lastCup",t={cupIndex:t.cupIndex});let k=e.turns.find($=>$.type=="lastCup");k&&k.teamIndex!=e.activeTeamIndex&&e.activePlayerIndex==1&&e.setModalGameOverVisible(!0),V(),R(),q(l,t),e.switchActivePlayer(),e.setModifier(void 0)},o=F(()=>e.isTeam1?e.activeTeamIndex===0:e.activeTeamIndex===1),v=(l,t)=>{let s=y(l,t);return e.cupsHit.includes(s)?"gray":e.isTeam1?"var(--main-color)":"var(--secondary-color)"},f=(l,t)=>{const s=h(t);l.style.top=`${s.offsetTop+25}px`,l.style.left=`${s.offsetLeft+25}px`},b=(l,t)=>{let s=document.getElementById(t);e.isTeam1?l.style.top=`${s.offsetTop}px`:l.style.bottom=`${s.getBoundingClientRect().top}px`,l.style.left="calc(50% - 15px)"},h=l=>document.getElementById(`ra-cup-team-${e.activeTeamIndex==0?1:0}-${l}`),c=(l,t)=>document.getElementById(`ra-ball-team-${l}-${t}`),I=F(()=>{let l=e.turns[e.turns.length-1];return l&&(l.type=="bomb"||l.type=="ballsback")||x==2||e.activePlayerIndex==1||e.cupsHitEnemyTeam.length==4&&[6,7,8,9].every(t=>e.cupsHitEnemyTeam.includes(t))||e.cupsHitEnemyTeam.length==6&&[3,5,6,7,8,9].every(t=>e.cupsHitEnemyTeam.includes(t))||e.cupsHitEnemyTeam.length==7&&[3,4,5,6,7,8,9].every(t=>e.cupsHitEnemyTeam.includes(t))?!1:e.cupsHitEnemyTeam.length==4||e.cupsHitEnemyTeam.length==6||e.cupsHitEnemyTeam.length==7}),M=()=>{let l=e.cupsHitEnemyTeam.length;for(;e.cupsHitEnemyTeam.length>0;)e.cupsHitEnemyTeam.pop();l==4&&e.cupsHitEnemyTeam.push(6,7,8,9),l==6&&e.cupsHitEnemyTeam.push(3,5,6,7,8,9),l==7&&e.cupsHitEnemyTeam.push(3,4,5,6,7,8,9),x++},B=()=>new Promise(l=>{const t=e.activeTeamIndex===0?1:0,s=Array.from({length:10},($,_)=>document.getElementById(`ra-cup-team-${t}-${_}`)),i=[],k=($,_)=>{_.stopPropagation(),_.preventDefault(),s.forEach((H,G)=>{H.removeEventListener("click",i[G],!0)}),l($)};s.forEach(($,_)=>{const H=G=>k(_,G);i[_]=H,$.addEventListener("click",H,!0)})}),R=()=>{if(e.activePlayerIndex!=0)for(let l=0;l<2;l++){let t=c(e.activeTeamIndex==0?1:0,l);t.style.opacity="0"}},V=()=>{e.activePlayerIndex!=0&&(d=[...new Set(d)],e.cupsHit.push(...d),d=[])},q=(l,t)=>{e.turns.push({playerIndex:e.activePlayerIndex,teamIndex:e.activeTeamIndex,type:l,data:t,time:new Date().getTime()})};return(l,t)=>(m(),p("div",{class:"Rack",style:g({transform:r.isTeam1?"rotate(0deg)":"rotate(180deg)"})},[A(n("div",ae,[n("div",le,P(r.infoText),1),n("div",se,[n("div",{class:"ra-button",onClick:t[0]||(t[0]=s=>r.setModifier("bouncer")),style:g({background:r.modifier=="bouncer"?"#6e1a22":r.isTeam1?"var(--main-color)":"var(--secondary-color)"})}," Bouncer ",4),n("div",{class:"ra-button",onClick:t[1]||(t[1]=s=>r.setModifier("trickshot")),style:g({background:r.modifier=="trickshot"?"#6e1a22":r.isTeam1?"var(--main-color)":"var(--secondary-color)"})}," Trickshot ",4)]),a(I)?(m(),p("div",{key:0,class:"ra-button",onClick:t[2]||(t[2]=s=>a(M)())},"Re-Rack")):N("",!0)],512),[[O,a(o)]]),A(n("div",{class:"ra-null",id:`ra-null-team-${r.isTeam1?"0":"1"}`,onClick:t[3]||(t[3]=s=>a(u)("miss",{})),style:g({outlineColor:r.isTeam1?"var(--main-color)":"var(--secondary-color)",color:r.isTeam1?"var(--main-color)":"var(--secondary-color)"})}," Nullwurf ",12,ie),[[O,!a(o)]]),n("div",{class:"ra-cups",style:g({opacity:a(o)?"0.3":"1",pointerEvents:a(o)?"none":"auto"})},[(m(),p(C,null,E(4,s=>n("div",{key:s,class:"ra-cups-row"},[(m(!0),p(C,null,E(s,i=>(m(),p("div",{onClick:k=>a(u)("hit",{cupIndex:a(y)(s,i)}),class:"ra-cups-cup",id:`ra-cup-team-${r.isTeam1?"0":"1"}-${a(y)(s,i)}`,style:g({background:a(v)(s,i),"pointer-events":r.cupsHit.includes(a(y)(s,i))?"none":"auto",width:a(o)?"13dvw":"20dvw",height:a(o)?"13dvw":"20dvw"})},null,12,re))),256))])),64))],4),A(n("div",{class:"ra-airball",id:`ra-airball-team-${r.isTeam1?"0":"1"}`,onClick:t[4]||(t[4]=s=>a(u)("airball",{})),style:g({outlineColor:r.isTeam1?"var(--main-color)":"var(--secondary-color)",color:r.isTeam1?"var(--main-color)":"var(--secondary-color)"})}," Airball ",12,ne),[[O,!a(o)]]),n("div",{id:`ra-ball-team-${r.isTeam1?"0":"1"}-0`,class:"ra-ball"},null,8,oe),n("div",{id:`ra-ball-team-${r.isTeam1?"0":"1"}-1`,class:"ra-ball"},null,8,ce)],4))}}),me=K(de,[["__scopeId","data-v-9150a7bc"]]),ue={class:"rt-modal"},ve=["id"],pe={class:"rt-modal-team"},ye={id:"bipoKnechtGames"},fe=["value"],he={class:"rt-modal-buttons"},Te=["onClick"],xe={key:0},be=z({__name:"ModalEnterTeam",props:{startGame:{type:Function,required:!0}},setup(r){let e=T(1),x=T(1),d=T(!1),y=T([]),u,o=T(0);J(async()=>{y.value=await ee()});const v=()=>{u={_id:"",team1:{_id:"",players:[]},team2:{_id:"",players:[]},time:new Date().getTime()};for(let b=1;b<3;b++){let c=document.getElementById("addOpenGameModal-team-"+b).getElementsByClassName("rt-modal-team");for(let I=0;I<c.length;I++){let B={_id:"",name:c[I].getElementsByClassName("rt-modal-input-player")[0].value.trim(),score:0};b==1?u.team1.players.push(B):u.team2.players.push(B)}}},f=()=>{W.go(-1)};return(b,h)=>(m(),j(Z,null,{title:w(()=>[L(P(a(d)?"Wer soll anfangen?":"Teams eintragen"),1)]),template:w(()=>[A(n("div",ue,[(m(),p(C,null,E(2,c=>n("div",{id:"addOpenGameModal-team-"+c,class:"rt-modal-container"},[(m(!0),p(C,null,E(c==1?a(e):a(x),I=>(m(),p("div",pe,[n("input",{list:"bipoKnechtGames",id:"openGameNames",class:"rt-modal-input-player",placeholder:"Spielername",style:g({textAlign:c==1?"right":"left",order:c==1?1:3})},null,4),n("datalist",ye,[(m(!0),p(C,null,E(a(y),M=>(m(),p("option",{value:M},null,8,fe))),256))])]))),256)),n("div",he,[n("div",{onClick:I=>c==1?S(e)?e.value++:e++:S(x)?x.value++:x++},"+",8,Te)])],8,ve)),64))],512),[[O,!a(d)]]),a(d)?(m(),p("div",xe,[n("div",{class:"rt-modal-startteam-selector",style:g({opacity:a(o)===0?1:.3}),onClick:h[0]||(h[0]=c=>S(o)?o.value=0:o=0)},P(a(u).team1.players.map(c=>c.name).join(", ")),5),n("div",{class:"rt-modal-startteam-selector",style:g([{opacity:a(o)===1?1:.3},{"margin-bottom":"40px"}]),onClick:h[1]||(h[1]=c=>S(o)?o.value=1:o=1)},P(a(u).team2.players.map(c=>c.name).join(", ")),5)])):N("",!0)]),cancle:w(()=>[n("div",{onClick:h[2]||(h[2]=c=>{f()})},"Abbrechen")]),confirm:w(()=>[A(n("div",{onClick:h[3]||(h[3]=c=>{S(d)?d.value=!0:d=!0,v()})},"Weiter",512),[[O,!a(d)]]),A(n("div",{onClick:h[4]||(h[4]=c=>r.startGame(a(u),a(o)))},"Spiel starten",512),[[O,a(d)]])]),_:1}))}}),ge=K(be,[["__scopeId","data-v-b3e89d61"]]),U=r=>(Q("data-v-273dedb1"),r=r(),X(),r),Ie=U(()=>n("div",null,"Spiel Ergebnis",-1)),ke={class:"mgo-result"},$e={class:"mgo-team"},_e={class:"mgo-team-score"},Ce={class:"mgo-player"},Ee={class:"mgo-player-name"},Be={class:"mgo-player-score"},Pe={class:"mgo-history"},He=U(()=>n("div",null,"Spiel Verlauf",-1)),we=z({__name:"ModalGameOver",props:{match:{type:Object,required:!0}},setup(r){const e=r;let x=(u,o)=>(u==0?e.match.team1:e.match.team2).players[o].name,d=u=>{switch(u){case"hit":return"Treffer";case"miss":return"Nullwurf";case"airball":return"Airball";case"bomb":return"Bombe";case"bouncer":return"Bouncer";case"trickshot":return"Trickshot";case"onfire":return"On Fire";case"ballsback":return"Treffer - Balls Back";case"lastCup":return"Letzter Becher";default:return u}},y=async()=>{await te(e.match)&&W.push({path:"/Offene-Spiele"})};return(u,o)=>(m(),j(Z,{class:"ModalGameOver"},{title:w(()=>[L("Spiel Beendet")]),template:w(()=>[Ie,n("div",ke,[(m(!0),p(C,null,E([r.match.team1,r.match.team2],v=>(m(),p("div",$e,[n("div",_e,P(v.players.reduce((f,b)=>f+b.score,0)),1),(m(!0),p(C,null,E(v.players,f=>(m(),p("div",Ce,[n("div",Ee,P(f.name),1),n("div",Be,P(f.score),1)]))),256))]))),256))]),n("div",Pe,[He,(m(!0),p(C,null,E(r.match.turns,(v,f)=>(m(),p("div",{class:"mgo-turn",style:g({"background-color":v.teamIndex==0?"var(--main-color)":"var(--secondary-color)"})},P(f+1+". "+a(x)(v.teamIndex,v.playerIndex)+" - "+a(d)(v.type)),5))),256))])]),confirm:w(()=>[n("div",{onClick:o[0]||(o[0]=v=>a(y)())},"BiPo Knecht beenden")]),_:1}))}}),Me=K(we,[["__scopeId","data-v-273dedb1"]]),Ge={class:"BiPoKnecht"},Ae={key:2,class:"bik-game"},Oe=z({__name:"_BiPoKnecht",setup(r){let e=T("Bob ist am Zug!"),x=T(!0),d=T(!1),y=T({_id:"placeholder",team1:{_id:"placeholder",players:[{_id:"placeholder",name:"",score:0},{_id:"placeholder",name:"",score:0}]},team2:{_id:"placeholder",players:[{_id:"placeholder",name:"",score:0},{_id:"placeholder",name:"",score:0}]},time:new Date().getTime()}),u=T([]),o=T(0),v=T(0),f=T(void 0),b=T([]),h=T([]),c=F(()=>o.value===0?y.value.team1:y.value.team2),I=F(()=>c.value.players[v.value]),M=(t,s)=>{y.value=t,x.value=!1,o.value=s,e.value=c.value.players[v.value].name+" ist am Zug!"},B=(t,s)=>{let i=s??v.value+1;if(i>c.value.players.length-1){i=0;let k=o.value==1?0:1;o.value=k}t!=null&&(o.value=t),v.value=i,e.value=c.value.players[v.value].name+" ist am Zug!"},R=t=>{f.value==t?f.value=void 0:f.value=t},V=t=>{e.value=t},q=t=>{d.value=t};Y(d,()=>{d.value&&(y.value.turns=u.value,y.value.turns.forEach((t,s)=>{let i=l(y.value,t.teamIndex,t.playerIndex);t.type=="bouncer"&&(i.score+=2),t.type=="lastCup"&&(i.score+=1),t.type=="bomb"&&(i.score+=1.5),t.type=="ballsback"&&(i.score+=1),t.type=="hit"&&(t.playerIndex==0&&y.value.turns[s+1].type=="bomb"?i.score+=1.5:i.score+=1)}))});let l=(t,s,i)=>(s==0?t.team1:t.team2).players[i];return(t,s)=>(m(),p("div",Ge,[a(x)?(m(),j(ge,{key:0,startGame:a(M)},null,8,["startGame"])):N("",!0),a(d)?(m(),j(Me,{key:1,match:a(y)},null,8,["match"])):N("",!0),a(x)?N("",!0):(m(),p("div",Ae,[(m(),p(C,null,E(2,i=>D(me,{isTeam1:i!=1,infoText:a(e),activeTeamIndex:a(o),activeTeam:a(c),activePlayer:a(I),turns:a(u),modifier:a(f),setModifier:a(R),setModalGameOverVisible:a(q),activePlayerIndex:a(v),cupsHit:i==1?a(h):a(b),cupsHitEnemyTeam:i==1?a(b):a(h),switchActivePlayer:a(B),setInfoText:a(V)},null,8,["isTeam1","infoText","activeTeamIndex","activeTeam","activePlayer","turns","modifier","setModifier","setModalGameOverVisible","activePlayerIndex","cupsHit","cupsHitEnemyTeam","switchActivePlayer","setInfoText"])),64))]))]))}}),Re=K(Oe,[["__scopeId","data-v-ae253b6b"]]);export{Re as default};
