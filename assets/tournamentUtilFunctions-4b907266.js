import{n as f}from"./index-387b0b0e.js";const D=t=>{for(var e=t.length-1;e>0;e--){var o=Math.floor(Math.random()*(e+1)),a=t[e];t[e]=t[o],t[o]=a}return t},p=t=>t.toString().split("").map(Number).map(e=>(e||10)+64).map(e=>String.fromCharCode(e)).join(""),I=(t,e,o)=>{let a=0,s=m(t);return o||(s=s.concat(n(t))),s.forEach(l=>{l.forEach(r=>{r.result&&(r.team1.name==e&&r.result.team1Score>r.result.team2Score&&(a+=1),r.team2.name==e&&r.result.team2Score>r.result.team1Score&&(a+=1))})}),a},E=(t,e,o)=>{let a=0,s=m(t);return o||(s=s.concat(n(t))),s.forEach(l=>{l.forEach(r=>{r.result&&(r.team1._id==e&&(a+=r.result.team1Score),r.team2._id==e&&(a+=r.result.team2Score))})}),a},P=(t,e,o)=>{let a=0,s=m(t);return o||(s=s.concat(n(t))),s.forEach(l=>{l.forEach(r=>{r.result&&(r.team1.players[0]==e&&(a+=r.result.team1Player1Score),r.team1.players[1]==e&&(a+=r.result.team1Player2Score),r.team2.players[0]==e&&(a+=r.result.team2Player1Score),r.team2.players[1]==e&&(a+=r.result.team2Player2Score))})}),a},w=(t,e,o)=>{let a=0,s=m(t);return o||(s=s.concat(n(t))),s.forEach(l=>{l.forEach(r=>{r.result&&(r.team1._id==e&&(a+=r.result.team2Score),r.team2._id==e&&(a+=r.result.team1Score))})}),a},T=(t,e,o)=>{let a=0,s=m(t);return o||(s=s.concat(n(t))),s.forEach(l=>{l.forEach(r=>{r.result&&(r.team1.players[0]==e&&a++,r.team1.players[1]==e&&a++,r.team2.players[0]==e&&a++,r.team2.players[1]==e&&a++)})}),a},O=(t,e,o)=>{let a=!1;return m(t).forEach(l=>{l.forEach(r=>{r.result&&r.team1._id==e&&r.team2._id==o&&(a=r.result.team1Score>r.result.Team2ID)})}),a},M=(t,e,o)=>{let a=m(t);o||(a=a.concat(n(t)));let s=0,l=0;return a.forEach(r=>{r.forEach(c=>{c.result&&(c.team1._id==e._id&&(l+=c.result.team2Score),c.team2._id==e._id&&(l+=c.result.team1Score),c.team1._id==e._id&&c.result.team1Score<c.result.team2Score&&(s+=c.result.team2Score-c.result.team1Score),c.team2._id==e._id&&c.result.team1Score>c.result.team2Score&&(s+=c.result.team1Score-c.result.team2Score))})}),s+l},k=async t=>{let e=await f.post("/getTournamentByName",{tournamentName:t});if(console.log(e.data.message),e.data.success)return e.data.tournament},x=async(t,e)=>{let o=await f.post("/addTeam",{tournamentID:t,team:e});return console.log(o.data.message),o.data.success},y=async(t,e)=>{let o=await f.post("/editTeam",{tournamentID:t,team:e});return console.log(o.data.message),o.data.success},C=async(t,e)=>{let o=await f.post("/removeTeam",{tournamentID:t,teamID:e});return console.log(o.data.message),o.data.success},h=(t,e)=>t.teams.find(a=>a._id==e),A=(t,e)=>t.teams.find(a=>a.name==e),G=t=>{if(!t||!t.groupPhase.groups)return[];let e=[];return t.groupPhase.groups.forEach((o,a)=>{e.push({teams:[]}),o.teams.forEach(s=>{let l=h(t,s.teamID);e[a].teams.push(l)})}),e},H=async(t,e)=>{let o=await f.post("/setGroups",{tournamentID:t,groups:e});return console.log(o.data.message),o.data.success},K=async t=>{let e=[],o=D(t.teams),a=t.groupPhase.settings.fixedGroupAmmount;for(let s=0;s<a;s++)e.push({teams:[]});for(let s=0;s<o.length;s++)e[s%a].teams.push({teamID:o[s]._id});await H(t._id,e)},v=t=>{let e=[];return G(t).forEach((o,a)=>{e.push({teams:[]}),o.teams.forEach(s=>{let l=s,r=E(t,l._id,!0),c=w(t,l._id,!0);l.wins=I(t,l.name,!0),l.games=T(t,l.players[0],!0),l.score=r+" : "+c,l.scoreDifference=r-c,l.hits=r,e[a].teams.push(l)})}),e.forEach(o=>{o.teams=o.teams.sort((a,s)=>a.hits==s.hits&&a.scoreDifference==s.scoreDifference&&a.wins==s.wins?O(t,a._id,s._id):s.scoreDifference==a.scoreDifference&&a.wins==s.wins?s.hits-a.hits:a.wins==s.wins?s.scoreDifference-a.scoreDifference:s.wins-a.wins)}),e},m=t=>{if(!t||!t.groupPhase.matches)return[];let e=[];return t.groupPhase.matches.forEach((o,a)=>{e.push([]),o.forEach(s=>{e[a].push({result:s.result,team1:h(t,s.team1ID),team2:h(t,s.team2ID),_id:s._id})})}),e},S=async(t,e)=>{let o=await f.post("/setMatchesGroupPhase",{tournamentID:t,matches:e});return console.log(o.data.message),o.data.success},B=async t=>{let e=[],o=t.groupPhase.groups;for(let a=0;a<o.length;a++){let s=[],l=o[a].teams;for(let r=0;r<l.length;r++)for(let c=r+1;c<l.length;c++){let u={team1ID:l[c].teamID,team2ID:l[r].teamID};s.push(u)}if(l.length==3){let r=s.length;for(let c=0;c<r;c++)s.push(s[c])}e.push(D(s))}await S(t._id,e)},W=async(t,e,o,a,s,l)=>{let r={team1Score:(o||0)+(a||0),team1Player1Score:o,team1Player2Score:a,team2Score:(a?s:0)+(l||0),team2Player1Score:s,team2Player2Score:l},c=t.groupPhase.matches;for(let u=0;u<c.length;u++)for(let i=0;i<c[u].length;i++)e==c[u][i]._id&&(c[u][i].result=r);await S(t._id,c),await _(t)},n=t=>{if(!t||!t.koPhase.matches)return[];let e=[];return t.koPhase.matches.forEach((o,a)=>{e.push([]),o.forEach(s=>{e[a].push({placeHolderTeam1:s.placeHolderTeam1,placeHolderTeam2:s.placeHolderTeam2,result:s.result,team1:h(t,s.team1ID),team2:h(t,s.team2ID),_id:s._id})})}),e},d=async(t,e)=>{let o=await f.post("/setMatchesKOPhase",{tournamentID:t,matches:e});return console.log(o.data.message),o.data.success},b=async t=>{let e=[],o=t.koPhase.settings.advancingTeamsPerGroup*t.groupPhase.groups.length,a=Math.log2(o);for(let s=0;s<a;s++){let l=o/Math.pow(2,s+1);if(e.push([]),s==0)for(let r=0;r<l;r++){let c,u;r%2==0?(c=p(r+1),u=p(r+2)):(c=p(l-r+1),u=p(l-r)),e[s].push({placeHolderTeam1:"1. Platz - Gruppe "+c,placeHolderTeam2:"2. Platz - Gruppe "+u})}else{for(let r=0;r<l;r++)e[s].push({placeHolderTeam1:"TBD",placeHolderTeam2:"TBD"});s==a-1&&e[s].push({placeHolderTeam1:"TBD",placeHolderTeam2:"TBD"})}}await d(t._id,e)},_=async t=>{let e=[],o=t.koPhase.matches,a=v(t);o.forEach((s,l)=>{if(e.push([]),l==0)for(let r=0;r<s.length;r++){let c=s[r],u,i;r%2==0?(u=r,i=r+1):(u=s.length-r,i=s.length-r-1),t.groupPhase.matches[u].find(g=>!g.result)||(c.team1ID=a[u].teams[0]._id),t.groupPhase.matches[i].find(g=>!g.result)||(c.team2ID=a[i].teams[1]._id),e[l].push(c)}else if(l==o.length-1){let r=s[0],c=s[1],u=o[l-1][0],i=o[l-1][1];u.result&&(r.team1ID=u.result.team1Score>u.result.team2Score?u.team1ID:u.team2ID,c.team1ID=u.result.team1Score>u.result.team2Score?u.team2ID:u.team1ID),i.result&&(r.team2ID=i.result.team1Score>i.result.team2Score?i.team1ID:i.team2ID,c.team2ID=i.result.team1Score>i.result.team2Score?i.team2ID:i.team1ID),e[l].push(r),e[l].push(c)}else for(let r=0;r<s.length;r++){let c=s[r],u=o[l-1][r*2],i=o[l-1][r*2+1];u.result&&(c.team1ID=u.result.team1Score>u.result.team2Score?u.team1ID:u.team2ID),i.result&&(c.team2ID=i.result.team1Score>i.result.team2Score?i.team1ID:i.team2ID),e[l].push(c)}}),await d(t._id,e)},R=async(t,e,o,a,s,l)=>{let r={team1Score:(o||0)+(a||0),team1Player1Score:o,team1Player2Score:a,team2Score:(a?s:0)+(l||0),team2Player1Score:s,team2Player2Score:l},c=t.koPhase.matches;for(let u=0;u<c.length;u++)for(let i=0;i<c[u].length;i++)e==c[u][i]._id&&(c[u][i].result=r);await d(t._id,c),await _(t)},z=t=>{let e=[],o=t.teams;for(let a=0;a<o.length;a++)for(let s=0;s<o[a].players.length;s++){let l={name:o[a].players[s],score:P(t,o[a].players[s],!1),ammountOfMatches:T(t,o[a].players[s],!1),ammountOfDrunkenCups:Math.ceil(M(t,o[a],!1)/2)};l.averageScore=(l.ammountOfMatches==0?0:l.score/l.ammountOfMatches).toFixed(2),e.push(l)}e.sort((a,s)=>s.averageScore==a.averageScore?s.ammountOfDrunkenCups-a.ammountOfDrunkenCups:s.averageScore-a.averageScore);for(let a=0;a<e.length;a++){e[a].placement=a;let s=e.filter(l=>l.averageScore==e[a].averageScore&&l.ammountOfDrunkenCups==e[a].ammountOfDrunkenCups);s.length>1&&s.forEach(l=>{l.placement=s[0].placement})}return e};export{v as a,G as b,p as c,z as d,m as e,x as f,k as g,y as h,A as i,B as j,b as k,K as l,S as m,n,W as o,R as p,C as r,H as s};
