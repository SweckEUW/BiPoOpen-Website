import{d as j,q as F,c as y,n as k,u as a,v as q,b as c,x as O,a as N,t as P,F as B,l as w,o as m,_ as K,r as g,j as J,k as z,w as G,m as R,h as L,z as W,p as Q,g as X,A as Y,e as D}from"./index-CawtYADw.js";import{M as Z}from"./Modal-DyqPsc-l.js";import{g as ee,a as te}from"./OpenGamesUtilFunctions-Ddua8xUR.js";const ae={class:"ra-middle"},le={style:{width:"100%","text-align":"center"}},se={class:"ra-buttons"},re=["id"],ie=["onClick","id"],ne=["id"],oe=["id"],ce=["id"],me=j({__name:"Rack",props:{isTeam1:{type:Boolean,required:!0},infoText:{type:String,required:!0},activeTeamIndex:{type:Number,required:!0},activeTeam:{type:Object,required:!0},activePlayer:{type:Object,required:!0},activePlayerIndex:{type:Number,required:!0},cupsHit:{type:Array,required:!0},cupsHitEnemyTeam:{type:Array,required:!0},switchActivePlayer:{type:Function,required:!0},turns:{type:Array,required:!0},modifier:{type:null,required:!0},setModifier:{type:Function,required:!0},setInfoText:{type:Function,required:!0},setModalGameOverVisible:{type:Function,required:!0}},setup(n){const t=n;let b=0,u=[],r=(l,e)=>{const s=l-1,o=e-1;return s*(s+1)/2+o},h=async(l,e)=>{let s=v(t.activeTeamIndex==0?1:0,t.activePlayerIndex);if(s.style.opacity="1",l=="miss"&&(console.log("Miss"),f(s,`ra-null-team-${t.activeTeamIndex==0?1:0}`)),l=="airball"&&(console.log("Airball"),f(s,`ra-airball-team-${t.activeTeamIndex==0?1:0}`)),l=="hit"&&(console.log("Hit"),u.push(e.cupIndex),d(s,e.cupIndex)),t.modifier=="bouncer"&&l=="hit"&&(console.log("Bouncer"),t.setInfoText(t.activePlayer.name+" bitte den zweiten Becher vom Bouncer auswählen!"),t.setModifier(void 0),l="bouncer",e={cupIndex1:e.cupIndex,cupIndex2:await I()},u.push(e.cupIndex2)),t.modifier=="trickshot"&&l=="miss"){console.log("Trickshot"),l="trickshot",S(l,e),t.switchActivePlayer(t.activeTeamIndex,t.activePlayerIndex),t.setModifier(void 0),t.setInfoText(t.activePlayer.name+" bitte Trickshot eintragen!");return}let o=t.turns[t.turns.length-1];if(t.activePlayerIndex!=0&&(o.type=="bouncer"||o.type=="hit")&&(l=="hit"||l=="bouncer")){let E=o.type=="hit"?o.data.cupIndex:o.data.cupIndex1,_=l=="hit"?e.cupIndex:e.cupIndex1;if(E==_){console.log("Bomb"),t.setInfoText(t.activePlayer.name+" bitte den zweiten Becher der Bombe auswählen!");let M=await I();t.setInfoText(t.activePlayer.name+" bitte den dritten Becher der Bombe auswählen!");let A=await I();l="bomb",e={cupIndex1:e.cupIndex,cupIndex2:M,cupIndex3:A},u.push(M,A)}else console.log("balls back"),l="ballsback",e={cupIndex1:e.cupIndex};V(),H(),S(l,e),t.switchActivePlayer(t.activeTeamIndex,0);return}t.cupsHit.length+u.length==10&&o.type!="lastCup"&&(console.log("lastCup"),l="lastCup",e={cupIndex:e.cupIndex});let C=t.turns.find(E=>E.type=="lastCup");C&&C.teamIndex!=t.activeTeamIndex&&t.activePlayerIndex==1&&t.setModalGameOverVisible(!0),V(),H(),S(l,e),t.switchActivePlayer(),t.setModifier(void 0)},i=F(()=>t.isTeam1?t.activeTeamIndex===0:t.activeTeamIndex===1),x=(l,e)=>{let s=r(l,e);return t.cupsHit.includes(s)?"gray":t.isTeam1?"var(--main-color)":"var(--secondary-color)"},d=(l,e)=>{const s=T(e);l.style.top=`${s.offsetTop+25}px`,l.style.left=`${s.offsetLeft+25}px`},f=(l,e)=>{let s=document.getElementById(e);t.isTeam1?l.style.top=`${s.offsetTop}px`:l.style.bottom=`${s.getBoundingClientRect().top}px`,l.style.left="calc(50% - 15px)"},T=l=>document.getElementById(`ra-cup-team-${t.activeTeamIndex==0?1:0}-${l}`),v=(l,e)=>document.getElementById(`ra-ball-team-${l}-${e}`),p=F(()=>{let l=t.turns[t.turns.length-1];return l&&(l.type=="bomb"||l.type=="ballsback")||b==2||t.activePlayerIndex==1||t.cupsHitEnemyTeam.length==4&&[6,7,8,9].every(e=>t.cupsHitEnemyTeam.includes(e))||t.cupsHitEnemyTeam.length==6&&[3,5,6,7,8,9].every(e=>t.cupsHitEnemyTeam.includes(e))||t.cupsHitEnemyTeam.length==7&&[3,4,5,6,7,8,9].every(e=>t.cupsHitEnemyTeam.includes(e))?!1:t.cupsHitEnemyTeam.length==4||t.cupsHitEnemyTeam.length==6||t.cupsHitEnemyTeam.length==7}),$=()=>{let l=t.cupsHitEnemyTeam.length;for(;t.cupsHitEnemyTeam.length>0;)t.cupsHitEnemyTeam.pop();l==4&&t.cupsHitEnemyTeam.push(6,7,8,9),l==6&&t.cupsHitEnemyTeam.push(3,5,6,7,8,9),l==7&&t.cupsHitEnemyTeam.push(3,4,5,6,7,8,9),b++},I=()=>new Promise(l=>{const e=t.activeTeamIndex===0?1:0,s=Array.from({length:10},(E,_)=>document.getElementById(`ra-cup-team-${e}-${_}`)),o=[],C=(E,_)=>{_.stopPropagation(),_.preventDefault(),s.forEach((M,A)=>{M.removeEventListener("click",o[A],!0)}),l(E)};s.forEach((E,_)=>{const M=A=>C(_,A);o[_]=M,E.addEventListener("click",M,!0)})}),H=()=>{if(t.activePlayerIndex!=0)for(let l=0;l<2;l++){let e=v(t.activeTeamIndex==0?1:0,l);e.style.opacity="0",e.style.top="auto",e.style.bottom="auto",e.style.left="auto",e.style.right="auto"}},V=()=>{t.activePlayerIndex!=0&&(u=[...new Set(u)],t.cupsHit.push(...u),u=[])},S=(l,e)=>{t.turns.push({playerIndex:t.activePlayerIndex,teamIndex:t.activeTeamIndex,type:l,data:e,time:new Date().getTime()})};return(l,e)=>(m(),y("div",{class:"Rack",style:k({transform:n.isTeam1?"rotate(0deg)":"rotate(180deg)",height:a(i)?"30%":"70%"})},[q(c("div",ae,[c("div",le,P(n.infoText),1),c("div",se,[c("div",{class:"ra-button",onClick:e[0]||(e[0]=s=>n.setModifier("bouncer")),style:k({background:n.modifier=="bouncer"?"#6e1a22":n.isTeam1?"var(--main-color)":"var(--secondary-color)"})}," Bouncer ",4),c("div",{class:"ra-button",onClick:e[1]||(e[1]=s=>n.setModifier("trickshot")),style:k({background:n.modifier=="trickshot"?"#6e1a22":n.isTeam1?"var(--main-color)":"var(--secondary-color)"})}," Trickshot ",4)]),a(p)?(m(),y("div",{key:0,class:"ra-button",onClick:e[2]||(e[2]=s=>a($)())},"Re-Rack")):N("",!0)],512),[[O,a(i)]]),q(c("div",{class:"ra-null",id:`ra-null-team-${n.isTeam1?"0":"1"}`,onClick:e[3]||(e[3]=s=>a(h)("miss",{})),style:k({outlineColor:n.isTeam1?"var(--main-color)":"var(--secondary-color)",color:n.isTeam1?"var(--main-color)":"var(--secondary-color)"})}," Nullwurf ",12,re),[[O,!a(i)]]),c("div",{class:"ra-cups",style:k({opacity:a(i)?"0.3":"1",pointerEvents:a(i)?"none":"auto"})},[(m(),y(B,null,w(4,s=>c("div",{key:s,class:"ra-cups-row"},[(m(!0),y(B,null,w(s,o=>(m(),y("div",{onClick:C=>a(h)("hit",{cupIndex:a(r)(s,o)}),class:"ra-cups-cup",id:`ra-cup-team-${n.isTeam1?"0":"1"}-${a(r)(s,o)}`,style:k({background:a(x)(s,o),"pointer-events":n.cupsHit.includes(a(r)(s,o))?"none":"auto",width:a(i)?"13dvw":"17dvw",height:a(i)?"13dvw":"17dvw"})},null,12,ie))),256))])),64))],4),q(c("div",{class:"ra-airball",id:`ra-airball-team-${n.isTeam1?"0":"1"}`,onClick:e[4]||(e[4]=s=>a(h)("airball",{})),style:k({outlineColor:n.isTeam1?"var(--main-color)":"var(--secondary-color)",color:n.isTeam1?"var(--main-color)":"var(--secondary-color)"})}," Airball ",12,ne),[[O,!a(i)]]),c("div",{id:`ra-ball-team-${n.isTeam1?"0":"1"}-0`,class:"ra-ball"},null,8,oe),c("div",{id:`ra-ball-team-${n.isTeam1?"0":"1"}-1`,class:"ra-ball"},null,8,ce)],4))}}),ue=K(me,[["__scopeId","data-v-1a306679"]]),de={class:"rt-modal"},ve=["id"],pe={class:"rt-modal-team"},ye={id:"bipoKnechtGames"},fe=["value"],he={class:"rt-modal-buttons"},xe=["onClick"],Te={key:0},ge=j({__name:"ModalEnterTeam",props:{startGame:{type:Function,required:!0}},setup(n){let t=g(1),b=g(1),u=g(!1),r=g([]),h,i=g(0);J(async()=>{r.value=await ee()});const x=()=>{h={_id:"placeholder",team1:{_id:"placeholder",players:[]},team2:{_id:"placeholder",players:[]}};for(let T=1;T<3;T++){let p=document.getElementById("addOpenGameModal-team-"+T).getElementsByClassName("rt-modal-team");for(let $=0;$<p.length;$++){let I=p[$].getElementsByClassName("rt-modal-input-player")[0].value.trim(),H={_id:"placeholder",name:I,score:0};T==1?(h.team1.players.push(H),p.length==1&&h.team1.players.push({_id:"placeholder",name:I,score:0})):(h.team2.players.push(H),p.length==1&&h.team2.players.push({_id:"placeholder",name:I,score:0}))}}},d=()=>{W.go(-1)};function f(T){return[...new Set(T.map(p=>p.name))].join(", ")}return(T,v)=>(m(),z(Z,null,{title:G(()=>[L(P(a(u)?"Wer soll anfangen?":"Teams eintragen"),1)]),template:G(()=>[q(c("div",de,[(m(),y(B,null,w(2,p=>c("div",{id:"addOpenGameModal-team-"+p,class:"rt-modal-container"},[(m(!0),y(B,null,w(p==1?a(t):a(b),$=>(m(),y("div",pe,[c("input",{list:"bipoKnechtGames",id:"openGameNames",class:"rt-modal-input-player",placeholder:"Spielername",style:k({textAlign:p==1?"right":"left",order:p==1?1:3})},null,4),c("datalist",ye,[(m(!0),y(B,null,w(a(r),I=>(m(),y("option",{value:I},null,8,fe))),256))])]))),256)),c("div",he,[c("div",{onClick:$=>p==1?R(t)?t.value++:t++:R(b)?b.value++:b++},"+",8,xe)])],8,ve)),64))],512),[[O,!a(u)]]),a(u)?(m(),y("div",Te,[c("div",{class:"rt-modal-startteam-selector",style:k({opacity:a(i)===0?1:.3}),onClick:v[0]||(v[0]=p=>R(i)?i.value=0:i=0)},P(f(a(h).team1.players)),5),c("div",{class:"rt-modal-startteam-selector",style:k([{opacity:a(i)===1?1:.3},{"margin-bottom":"40px"}]),onClick:v[1]||(v[1]=p=>R(i)?i.value=1:i=1)},P(f(a(h).team2.players)),5)])):N("",!0)]),cancle:G(()=>[c("div",{onClick:v[2]||(v[2]=p=>{d()})},"Abbrechen")]),confirm:G(()=>[q(c("div",{onClick:v[3]||(v[3]=p=>{R(u)?u.value=!0:u=!0,x()})},"Weiter",512),[[O,!a(u)]]),q(c("div",{onClick:v[4]||(v[4]=p=>n.startGame(a(h),a(i)))},"Spiel starten",512),[[O,a(u)]])]),_:1}))}}),be=K(ge,[["__scopeId","data-v-7e34f68b"]]),U=n=>(Q("data-v-eb1dc153"),n=n(),X(),n),Ie=U(()=>c("div",null,"Spiel Ergebnis",-1)),ke={class:"mgo-result"},$e={class:"mgo-team"},Ce={key:0,class:"mgo-team-score"},Ee={class:"mgo-player"},_e={class:"mgo-player-name"},Pe={class:"mgo-player-score"},Be={class:"mgo-history"},we=U(()=>c("div",null,"Spiel Verlauf",-1)),He=j({__name:"ModalGameOver",props:{match:{type:Object,required:!0}},setup(n){const t=n;let b=(i,x)=>(i==0?t.match.team1:t.match.team2).players[x].name;function u(i,x){const d=x-i,f=Math.floor(d/6e4),T=Math.floor(d%6e4/1e3);return`${f}:${String(T).padStart(2,"0")} Minuten`}let r=i=>{switch(i){case"hit":return"Treffer";case"miss":return"Nullwurf";case"airball":return"Airball";case"bomb":return"Bombe";case"bouncer":return"Bouncer";case"trickshot":return"Trickshot";case"onfire":return"On Fire";case"ballsback":return"Treffer - Balls Back";case"lastCup":return"Letzter Becher";default:return i}},h=async()=>{console.log(t.match),await te(t.match)&&W.push({path:"/Offene-Spiele"})};return(i,x)=>(m(),z(Z,{class:"ModalGameOver"},{title:G(()=>[L("Spiel Beendet")]),template:G(()=>[Ie,c("div",ke,[(m(!0),y(B,null,w([n.match.team1,n.match.team2],d=>(m(),y("div",$e,[d.players.length>1?(m(),y("div",Ce,P(d.players.reduce((f,T)=>f+T.score,0)),1)):N("",!0),(m(!0),y(B,null,w(d.players,f=>(m(),y("div",Ee,[c("div",_e,P(f.name),1),c("div",Pe,P(f.score),1)]))),256))]))),256))]),c("div",null,P("Dauer: "+u(n.match.time,n.match.endTime)),1),c("div",Be,[we,(m(!0),y(B,null,w(n.match.turns,(d,f)=>(m(),y("div",{class:"mgo-turn",style:k({"background-color":d.teamIndex==0?"var(--main-color)":"var(--secondary-color)"})},P(f+1+". "+a(b)(d.teamIndex,d.playerIndex)+" - "+a(r)(d.type)),5))),256))])]),confirm:G(()=>[c("div",{onClick:x[0]||(x[0]=d=>a(h)())},"BiPo Knecht beenden")]),_:1}))}}),Me=K(He,[["__scopeId","data-v-eb1dc153"]]),Ge={class:"BiPoKnecht"},Ae={key:2,class:"bik-game"},qe=j({__name:"_BiPoKnecht",setup(n){let t=g("Bob ist am Zug!"),b=g(!0),u=g(!1),r=g({_id:"placeholder",team1:{_id:"placeholder",players:[{_id:"placeholder",name:"",score:0},{_id:"placeholder",name:"",score:0}]},team2:{_id:"placeholder",players:[{_id:"placeholder",name:"",score:0},{_id:"placeholder",name:"",score:0}]},time:new Date().getTime()}),h=g([]),i=g(0),x=g(0),d=g(void 0),f=g([]),T=g([]),v=F(()=>i.value===0?r.value.team1:r.value.team2),p=F(()=>v.value.players[x.value]),$=(e,s)=>{r.value=e,b.value=!1,i.value=s,t.value=v.value.players[x.value].name+" ist am Zug!",document.documentElement.requestFullscreen(),r.value.time=new Date().getTime()},I=(e,s)=>{let o=s??x.value+1;if(o>v.value.players.length-1){o=0;let C=i.value==1?0:1;i.value=C}e!=null&&(i.value=e),x.value=o,t.value=v.value.players[x.value].name+" ist am Zug!"},H=e=>{d.value==e?d.value=void 0:d.value=e},V=e=>{t.value=e},S=e=>{u.value=e};Y(u,()=>{u.value&&(document.exitFullscreen(),r.value.turns=h.value,r.value.turns.forEach((e,s)=>{let o=l(r.value,e.teamIndex,e.playerIndex);e.type=="bouncer"&&(o.score+=2),e.type=="lastCup"&&(o.score+=1),e.type=="bomb"&&(o.score+=1.5),e.type=="ballsback"&&(o.score+=1),e.type=="hit"&&(e.playerIndex==0&&r.value.turns[s+1].type=="bomb"?o.score+=1.5:o.score+=1)}),r.value.team1.players[0].name==r.value.team1.players[1].name&&(r.value.turns.forEach(e=>{e.teamIndex==0&&(e.playerIndex=0)}),r.value.team1.players[0].score+=r.value.team1.players[1].score,r.value.team1.players=[r.value.team1.players[0]]),r.value.team2.players[0].name==r.value.team2.players[1].name&&(r.value.turns.forEach(e=>{e.teamIndex==1&&(e.playerIndex=0)}),r.value.team2.players[0].score+=r.value.team2.players[1].score,r.value.team2.players=[r.value.team2.players[0]]),r.value.endTime=new Date().getTime())});let l=(e,s,o)=>(s==0?e.team1:e.team2).players[o];return(e,s)=>(m(),y("div",Ge,[a(b)?(m(),z(be,{key:0,startGame:a($)},null,8,["startGame"])):N("",!0),a(u)?(m(),z(Me,{key:1,match:a(r)},null,8,["match"])):N("",!0),a(b)?N("",!0):(m(),y("div",Ae,[(m(),y(B,null,w(2,o=>D(ue,{isTeam1:o!=1,infoText:a(t),activeTeamIndex:a(i),activeTeam:a(v),activePlayer:a(p),turns:a(h),modifier:a(d),setModifier:a(H),setModalGameOverVisible:a(S),activePlayerIndex:a(x),cupsHit:o==1?a(T):a(f),cupsHitEnemyTeam:o==1?a(f):a(T),switchActivePlayer:a(I),setInfoText:a(V)},null,8,["isTeam1","infoText","activeTeamIndex","activeTeam","activePlayer","turns","modifier","setModifier","setModalGameOverVisible","activePlayerIndex","cupsHit","cupsHitEnemyTeam","switchActivePlayer","setInfoText"])),64))]))]))}}),Re=K(qe,[["__scopeId","data-v-dabd468d"]]);export{Re as default};
