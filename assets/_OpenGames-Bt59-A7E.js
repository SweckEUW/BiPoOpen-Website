import{j as I,d as b,r as h,o as u,k as O,w as G,g as F,a as l,c as g,l as w,n as x,t as p,F as _,u as v,m as W,p as M,h as E,_ as $,q as f,s as D,b as C,v as L,x as q,y as B,e as k,T as V,z,i as j}from"./index-vtPsVOIY.js";import{M as H}from"./Modal-B6jclO9a.js";import{L as U}from"./Loadingscreen-BIzMTxQv.js";const N=async()=>{let a=await I.get("/openGames");if(console.log(a.data.message),a.data.success)return a.data.openGames},R=async a=>{let t=await I.post("/addOpenGame",a);return console.log(t.data.message),t.data.success},J=a=>{let t=K(a);t.sort((e,s)=>s.averageWins==e.averageWins?s.wins-e.wins:s.averageWins-e.averageWins);for(let e=0;e<t.length;e++){t[e].placement=e;let s=t.filter(n=>n.averageScore==t[e].averageScore&&n.ammountOfDrunkenCups==t[e].ammountOfDrunkenCups);s.length>1&&s.forEach(n=>{n.placement=s[0].placement})}return t},K=a=>{let t=[];return Q(a).forEach(s=>{let n=A(a,s).length,r=Y(a,s),m=X(a,s),o={name:s,score:r,ammountOfMatches:n,ammountOfDrunkenCups:Z(),wins:m,averageScore:Math.round((n==0?0:r/n)*100)/100,averageWins:Math.round((n==0?0:m/n)*100)};t.push(o)}),t},Q=a=>{let t=[];return a.forEach(e=>{t.push(...e.team1.players.map(s=>s.name)),t.push(...e.team2.players.map(s=>s.name))}),t=t.filter((e,s)=>t.indexOf(e)==s),t},A=(a,t)=>{let e=[];return a.forEach(s=>{(s.team1.players.map(n=>n.name).includes(t)||s.team2.players.map(n=>n.name).includes(t))&&e.push(s)}),e},X=(a,t)=>{let e=0;return A(a,t).forEach(n=>{if(n.team1.players.map(r=>r.name).includes(t)){let r=n.team1.players.reduce((o,c)=>o+c.score,0),m=n.team2.players.reduce((o,c)=>o+c.score,0);r>m&&e++}if(n.team2.players.map(r=>r.name).includes(t)){let r=n.team1.players.reduce((o,c)=>o+c.score,0);n.team2.players.reduce((o,c)=>o+c.score,0)>r&&e++}}),e},Y=(a,t)=>{let e=0;return A(a,t).forEach(n=>{n.team1.players.map(r=>r.name).includes(t)&&(e+=n.team1.players.find(r=>r.name==t).score),n.team2.players.map(r=>r.name).includes(t)&&(e+=n.team2.players.find(r=>r.name==t).score)}),e},Z=(a,t)=>1,ee=a=>(M("data-v-059d5bb2"),a=a(),E(),a),te={class:"rt-modal"},ae=["id"],se={class:"rt-modal-team"},ne=ee(()=>l("input",{class:"rt-modal-input-number",type:"number",placeholder:"0"},null,-1)),le={class:"rt-modal-buttons"},oe=["onClick"],re=b({__name:"ModalAddOpenGame",props:{toggleModalAddGame:{type:Function,required:!0},getOpenGames:{type:Function,required:!0}},setup(a){let t=h(1),e=h(1);const s=a,n=async()=>{let r={team1:{players:[]},team2:{players:[]},time:new Date().getTime()};for(let o=1;o<3;o++){let d=document.getElementById("addOpenGameModal-team-"+o).getElementsByClassName("rt-modal-team");for(let i=0;i<d.length;i++){let S=d[i].getElementsByClassName("rt-modal-input-player")[0].value,T=parseFloat(d[i].getElementsByClassName("rt-modal-input-number")[0].value),P={name:S,score:T};o==1?r.team1.players.push(P):r.team2.players.push(P)}}await R(r)&&(await s.getOpenGames(),s.toggleModalAddGame())};return(r,m)=>(u(),O(H,null,{title:G(()=>[F("Ergebnis eintragen")]),template:G(()=>[l("div",te,[(u(),g(_,null,w(2,o=>l("div",{id:"addOpenGameModal-team-"+o,class:"rt-modal-container"},[l("div",{class:"rt-modal-score",style:x({textAlign:o==1?"right":"left"})},p(0),4),(u(!0),g(_,null,w(o==1?v(t):v(e),c=>(u(),g("div",se,[l("input",{class:"rt-modal-input-player",type:"string",placeholder:"Spielername",style:x({textAlign:o==1?"right":"left",order:o==1?1:3})},null,4),ne]))),256)),l("div",le,[l("div",{onClick:c=>o==1?W(t)?t.value++:t++:W(e)?e.value++:e++},"+",8,oe)])],8,ae)),64))])]),cancle:G(()=>[l("div",{onClick:m[0]||(m[0]=o=>{a.toggleModalAddGame()})},"Abbrechen")]),confirm:G(()=>[l("div",{onClick:m[1]||(m[1]=o=>n())},"Eintragen")]),_:1}))}}),ie=$(re,[["__scopeId","data-v-059d5bb2"]]),ce={class:"OpenGameMatchElement"},de={class:"ogm-time"},me={class:"ogm-game"},ue={class:"ogm-game-team"},pe={class:"ogm-game-team-player-name"},ve={class:"ogm-game-team-player-score"},ge=b({__name:"OpenGameMatchElement",props:{openGame:{type:Object,required:!0}},setup(a){const t=a;let e=new Date(t.openGame.time),s=e.getHours()+":"+e.getMinutes(),n=t.openGame.team1.players.reduce((o,c)=>o+c.score,0),r=t.openGame.team2.players.reduce((o,c)=>o+c.score,0),m=h(n<r);return(o,c)=>(u(),g("div",ce,[l("div",de,p(v(e).toLocaleDateString("de-DE")+"  -  "+v(s)+" Uhr"),1),l("div",me,[(u(!0),g(_,null,w([a.openGame.team1,a.openGame.team2],(d,i)=>(u(),g("div",ue,[(u(!0),g(_,null,w(d.players,S=>(u(),g("div",{class:f(["ogm-game-team-player",{teamLoose:i==0&&v(m)||i==1&&!v(m)}])},[l("div",pe,p(S.name),1),l("div",ve,p(S.score),1)],2))),256))]))),256))])]))}}),he=$(ge,[["__scopeId","data-v-74d15203"]]),y=a=>(M("data-v-a8275ba4"),a=a(),E(),a),fe={class:"table table-hover caption-top"},_e={style:{height:"auto"}},Se={key:0,class:"ogs-explain"},we=y(()=>l("div",null,"*Pl. = Platz",-1)),Ge=y(()=>l("div",null,"*Spi. = Spiele",-1)),ye=y(()=>l("div",null,"*Sieg. = Siege",-1)),Oe=y(()=>l("div",null,"*Trfq. = Trefferquote",-1)),be=y(()=>l("div",null,"*Siegwahr. = Siegwahrscheinlichkeit",-1)),$e=[we,Ge,ye,Oe,be],ke=b({__name:"OpenGamesStatistics",props:{openGames:{type:Object,required:!0}},setup(a){const t=a;let e=h("averageWins"),s=h(!1),n=h(window.screen.width);window.addEventListener("resize",()=>{n.value=window.screen.width});const r=D(()=>{let c=J(t.openGames);return c.sort((d,i)=>e.value=="name"?s.value?d[e.value].localeCompare(i[e.value]):i[e.value].localeCompare(d[e.value]):i[e.value]==d[e.value]?s.value?i.placement-d.placement:d.placement-i.placement:s.value?d[e.value]-i[e.value]:i[e.value]-d[e.value]),c}),m=c=>{e.value==c?s.value=!s.value:s.value=!1,e.value=c},o=c=>{if(c==e.value)return s.value?"ogs-arrow ogs-arrow-up":"ogs-arrow ogs-arrow-down"};return(c,d)=>(u(),g(_,null,[l("table",fe,[l("thead",null,[l("tr",_e,[l("th",{onClick:d[0]||(d[0]=i=>m("placement")),class:f(o("placement"))},p(v(n)>900?"Platz":"Pl."),3),l("th",{onClick:d[1]||(d[1]=i=>m("name")),class:f(o("name"))},p("Name"),2),l("th",{onClick:d[2]||(d[2]=i=>m("ammountOfMatches")),class:f(o("ammountOfMatches"))},p(v(n)>900?"Spiele":"Spi."),3),l("th",{onClick:d[3]||(d[3]=i=>m("wins")),class:f(o("wins"))},p(v(n)>900?"Siege":"Sieg."),3),l("th",{onClick:d[4]||(d[4]=i=>m("averageScore")),class:f(o("averageScore"))},p(v(n)>900?"Trefferquote":"Trfq."),3),l("th",{onClick:d[5]||(d[5]=i=>m("averageWins")),class:f(o("averageWins"))},p(v(n)>900?"Siegwahrscheinlichkeit":"Siegwahr."),3)])]),l("tbody",null,[(u(!0),g(_,null,w(r.value,(i,S)=>(u(),g("tr",{key:S},[l("td",null,p(i.placement+1),1),l("td",null,p(i.name.replace(" ",`
`)),1),l("td",null,p(i.ammountOfMatches),1),l("td",null,p(i.wins),1),l("td",null,p(i.averageScore),1),l("td",null,p(i.averageWins+"%"),1)]))),128))])]),v(n)<900?(u(),g("div",Se,$e)):C("",!0)],64))}}),Ce=$(ke,[["__scopeId","data-v-a8275ba4"]]),Me=a=>(M("data-v-7d0ccde8"),a=a(),E(),a),Ee={class:"HallofFame"},Ae=Me(()=>l("h1",{class:"bp-title"},p("Offene Spiele"),-1)),Pe={key:0},xe=j('<ul class="nav nav-tabs justify-content-center" data-v-7d0ccde8><li class="nav-item" data-v-7d0ccde8><button class="nav-link active" data-bs-toggle="tab" data-bs-target="#OpenGamesMain" data-v-7d0ccde8>Vergangene Spiele</button></li><li class="nav-item" data-v-7d0ccde8><button class="nav-link" data-bs-toggle="tab" data-bs-target="#OpenGamesStats" data-v-7d0ccde8>Statistiken</button></li></ul>',1),We={class:"tab-content",id:"GameScheduleContainer"},Ie={class:"tab-pane fade show active",id:"OpenGamesMain"},Te={class:"tab-pane fade",id:"OpenGamesStats"},Fe=b({__name:"_OpenGames",setup(a){let t=h(),e=h(!1);const s=async()=>{t.value=await N(),t.value=t.value.reverse()};s();let n=setInterval(()=>{s()},1e4);L(()=>{clearInterval(n)});const r=()=>{e.value=!e.value};return(m,o)=>(u(),g("div",Ee,[Ae,q(k(U,null,null,512),[[B,!v(t)]]),v(t)?(u(),g("div",Pe,[l("div",{class:"bp-button",onClick:o[0]||(o[0]=c=>r())},"Spiel eintragen"),(u(),O(z,{to:"body"},[k(V,{name:"fade"},{default:G(()=>[v(e)?(u(),O(ie,{key:0,toggleModalAddGame:r,getOpenGames:s})):C("",!0)]),_:1})])),xe,l("div",We,[l("div",Ie,[(u(!0),g(_,null,w(v(t),c=>(u(),O(he,{openGame:c},null,8,["openGame"]))),256))]),l("div",Te,[k(Ce,{openGames:v(t)},null,8,["openGames"])])])])):C("",!0)]))}}),Be=$(Fe,[["__scopeId","data-v-7d0ccde8"]]);export{Be as default};
